#include "task.h"

int16_t bob[BOBMAX] ={ // +2.8V ~ -2.8V / 3.3V
    0,      87,     174,    262,    349,    436,    524,    611,    698,    786,
    873,    960,    1047,   1135,   1222,   1309,   1396,   1484,   1571,   1658,
    1745,   1832,   1920,   2007,   2094,   2181,   2268,   2355,   2442,   2529,
    2616,   2703,   2790,   2877,   2964,   3050,   3137,   3224,   3311,   3397,
    3484,   3571,   3657,   3744,   3830,   3917,   4003,   4090,   4176,   4263,
    4349,   4435,   4521,   4607,   4694,   4780,   4866,   4952,   5038,   5123,
    5209,   5295,   5381,   5466,   5552,   5638,   5723,   5809,   5894,   5979,
    6065,   6150,   6235,   6320,   6405,   6490,   6575,   6660,   6744,   6829,
    6914,   6998,   7083,   7167,   7252,   7336,   7420,   7504,   7588,   7672,
    7756,   7840,   7924,   8008,   8091,   8175,   8258,   8342,   8425,   8508,
    8591,   8674,   8757,   8840,   8923,   9005,   9088,   9170,   9253,   9335,
    9417,   9500,   9582,   9664,   9745,   9827,   9909,   9990,   10072,  10153,
    10234,  10316,  10397,  10478,  10558,  10639,  10720,  10800,  10881,  10961,
    11041,  11122,  11202,  11281,  11361,  11441,  11520,  11600,  11679,  11758,
    11837,  11916,  11995,  12074,  12153,  12231,  12310,  12388,  12466,  12544,
    12622,  12700,  12777,  12855,  12932,  13009,  13086,  13163,  13240,  13317,
    13394,  13470,  13547,  13623,  13699,  13775,  13851,  13926,  14002,  14077,
    14152,  14227,  14302,  14377,  14452,  14527,  14601,  14675,  14749,  14823,
    14897,  14971,  15044,  15118,  15191,  15264,  15337,  15410,  15482,  15555,
    15627,  15699,  15771,  15843,  15915,  15986,  16058,  16129,  16200,  16271,
    16342,  16412,  16483,  16553,  16623,  16693,  16763,  16832,  16902,  16971,
    17040,  17109,  17178,  17246,  17315,  17383,  17451,  17519,  17587,  17654,
    17722,  17789,  17856,  17923,  17990,  18056,  18122,  18189,  18255,  18320,
    18386,  18451,  18517,  18582,  18647,  18711,  18776,  18840,  18904,  18968,
    19032,  19096,  19159,  19222,  19285,  19348,  19411,  19473,  19535,  19597,
    19659,  19721,  19782,  19844,  19905,  19966,  20026,  20087,  20147,  20207,
    20267,  20327,  20386,  20445,  20505,  20563,  20622,  20681,  20739,  20797,
    20855,  20912,  20970,  21027,  21084,  21141,  21198,  21254,  21310,  21366,
    21422,  21478,  21533,  21588,  21643,  21698,  21752,  21807,  21861,  21915,
    21968,  22022,  22075,  22128,  22181,  22233,  22285,  22338,  22389,  22441,
    22493,  22544,  22595,  22646,  22696,  22747,  22797,  22847,  22896,  22946,
    22995,  23044,  23093,  23141,  23189,  23237,  23285,  23333,  23380,  23427,
    23474,  23521,  23567,  23614,  23660,  23705,  23751,  23796,  23841,  23886,
    23931,  23975,  24019,  24063,  24107,  24150,  24193,  24236,  24279,  24321,
    24363,  24405,  24447,  24489,  24530,  24571,  24612,  24652,  24692,  24732,
    24772,  24812,  24851,  24890,  24929,  24967,  25006,  25044,  25082,  25119,
    25156,  25193,  25230,  25267,  25303,  25339,  25375,  25411,  25446,  25481,
    25516,  25550,  25585,  25619,  25653,  25686,  25719,  25752,  25785,  25818,
    25850,  25882,  25914,  25945,  25977,  26008,  26038,  26069,  26099,  26129,
    26159,  26188,  26217,  26246,  26275,  26304,  26332,  26360,  26387,  26415,
    26442,  26469,  26495,  26522,  26548,  26573,  26599,  26624,  26649,  26674,
    26699,  26723,  26747,  26770,  26794,  26817,  26840,  26863,  26885,  26907,
    26929,  26951,  26972,  26993,  27014,  27034,  27055,  27075,  27094,  27114,
    27133,  27152,  27170,  27189,  27207,  27225,  27242,  27260,  27277,  27294,
    27310,  27326,  27342,  27358,  27373,  27388,  27403,  27418,  27432,  27446,
    27460,  27474,  27487,  27500,  27513,  27525,  27537,  27549,  27561,  27572,
    27583,  27594,  27605,  27615,  27625,  27635,  27644,  27653,  27662,  27671,
    27679,  27687,  27695,  27703,  27710,  27717,  27724,  27730,  27736,  27742,
    27748,  27753,  27758,  27763,  27767,  27772,  27776,  27779,  27783,  27786,
    27789,  27791,  27794,  27796,  27798,  27799,  27800,  27801,  27802,  27802,
    27802,  27802,  27802,  27801,  27800,  27799,  27798,  27796,  27794,  27791,
    27789,  27786,  27783,  27779,  27776,  27772,  27767,  27763,  27758,  27753,
    27748,  27742,  27736,  27730,  27724,  27717,  27710,  27703,  27695,  27687,
    27679,  27671,  27662,  27653,  27644,  27635,  27625,  27615,  27605,  27594,
    27583,  27572,  27561,  27549,  27537,  27525,  27513,  27500,  27487,  27474,
    27460,  27446,  27432,  27418,  27403,  27388,  27373,  27358,  27342,  27326,
    27310,  27294,  27277,  27260,  27242,  27225,  27207,  27189,  27170,  27152,
    27133,  27114,  27094,  27075,  27055,  27034,  27014,  26993,  26972,  26951,
    26929,  26907,  26885,  26863,  26840,  26817,  26794,  26770,  26747,  26723,
    26699,  26674,  26649,  26624,  26599,  26573,  26548,  26522,  26495,  26469,
    26442,  26415,  26387,  26360,  26332,  26304,  26275,  26246,  26217,  26188,
    26159,  26129,  26099,  26069,  26038,  26008,  25977,  25945,  25914,  25882,
    25850,  25818,  25785,  25752,  25719,  25686,  25653,  25619,  25585,  25550,
    25516,  25481,  25446,  25411,  25375,  25339,  25303,  25267,  25230,  25193,
    25156,  25119,  25082,  25044,  25006,  24967,  24929,  24890,  24851,  24812,
    24772,  24732,  24692,  24652,  24612,  24571,  24530,  24489,  24447,  24405,
    24363,  24321,  24279,  24236,  24193,  24150,  24107,  24063,  24019,  23975,
    23931,  23886,  23841,  23796,  23751,  23705,  23660,  23614,  23567,  23521,
    23474,  23427,  23380,  23333,  23285,  23237,  23189,  23141,  23093,  23044,
    22995,  22946,  22896,  22847,  22797,  22747,  22696,  22646,  22595,  22544,
    22493,  22441,  22389,  22338,  22285,  22233,  22181,  22128,  22075,  22022,
    21968,  21915,  21861,  21807,  21752,  21698,  21643,  21588,  21533,  21478,
    21422,  21366,  21310,  21254,  21198,  21141,  21084,  21027,  20970,  20912,
    20855,  20797,  20739,  20681,  20622,  20563,  20505,  20445,  20386,  20327,
    20267,  20207,  20147,  20087,  20026,  19966,  19905,  19844,  19782,  19721,
    19659,  19597,  19535,  19473,  19411,  19348,  19285,  19222,  19159,  19096,
    19032,  18968,  18904,  18840,  18776,  18711,  18647,  18582,  18517,  18451,
    18386,  18320,  18255,  18189,  18122,  18056,  17990,  17923,  17856,  17789,
    17722,  17654,  17587,  17519,  17451,  17383,  17315,  17246,  17178,  17109,
    17040,  16971,  16902,  16832,  16763,  16693,  16623,  16553,  16483,  16412,
    16342,  16271,  16200,  16129,  16058,  15986,  15915,  15843,  15771,  15699,
    15627,  15555,  15482,  15410,  15337,  15264,  15191,  15118,  15044,  14971,
    14897,  14823,  14749,  14675,  14601,  14527,  14452,  14377,  14302,  14227,
    14152,  14077,  14002,  13926,  13851,  13775,  13699,  13623,  13547,  13470,
    13394,  13317,  13240,  13163,  13086,  13009,  12932,  12855,  12777,  12700,
    12622,  12544,  12466,  12388,  12310,  12231,  12153,  12074,  11995,  11916,
    11837,  11758,  11679,  11600,  11520,  11441,  11361,  11281,  11202,  11122,
    11041,  10961,  10881,  10800,  10720,  10639,  10558,  10478,  10397,  10316,
    10234,  10153,  10072,  9990,   9909,   9827,   9745,   9664,   9582,   9500,
    9417,   9335,   9253,   9170,   9088,   9005,   8923,   8840,   8757,   8674,
    8591,   8508,   8425,   8342,   8258,   8175,   8091,   8008,   7924,   7840,
    7756,   7672,   7588,   7504,   7420,   7336,   7252,   7167,   7083,   6998,
    6914,   6829,   6744,   6660,   6575,   6490,   6405,   6320,   6235,   6150,
    6065,   5979,   5894,   5809,   5723,   5638,   5552,   5466,   5381,   5295,
    5209,   5123,   5038,   4952,   4866,   4780,   4694,   4607,   4521,   4435,
    4349,   4263,   4176,   4090,   4003,   3917,   3830,   3744,   3657,   3571,
    3484,   3397,   3311,   3224,   3137,   3050,   2964,   2877,   2790,   2703,
    2616,   2529,   2442,   2355,   2268,   2181,   2094,   2007,   1920,   1832,
    1745,   1658,   1571,   1484,   1396,   1309,   1222,   1135,   1047,   960,
    873,    786,    698,    611,    524,    436,    349,    262,    174,    87,
    0,      -87,    -174,   -262,   -349,   -436,   -524,   -611,   -698,   -786,
    -873,   -960,   -1047,  -1135,  -1222,  -1309,  -1396,  -1484,  -1571,  -1658,
    -1745,  -1832,  -1920,  -2007,  -2094,  -2181,  -2268,  -2355,  -2442,  -2529,
    -2616,  -2703,  -2790,  -2877,  -2964,  -3050,  -3137,  -3224,  -3311,  -3397,
    -3484,  -3571,  -3657,  -3744,  -3830,  -3917,  -4003,  -4090,  -4176,  -4263,
    -4349,  -4435,  -4521,  -4607,  -4694,  -4780,  -4866,  -4952,  -5038,  -5123,
    -5209,  -5295,  -5381,  -5466,  -5552,  -5638,  -5723,  -5809,  -5894,  -5979,
    -6065,  -6150,  -6235,  -6320,  -6405,  -6490,  -6575,  -6660,  -6744,  -6829,
    -6914,  -6998,  -7083,  -7167,  -7252,  -7336,  -7420,  -7504,  -7588,  -7672,
    -7756,  -7840,  -7924,  -8008,  -8091,  -8175,  -8258,  -8342,  -8425,  -8508,
    -8591,  -8674,  -8757,  -8840,  -8923,  -9005,  -9088,  -9170,  -9253,  -9335,
    -9417,  -9500,  -9582,  -9664,  -9745,  -9827,  -9909,  -9990,  -10072, -10153,
    -10234, -10316, -10397, -10478, -10558, -10639, -10720, -10800, -10881, -10961,
    -11041, -11122, -11202, -11281, -11361, -11441, -11520, -11600, -11679, -11758,
    -11837, -11916, -11995, -12074, -12153, -12231, -12310, -12388, -12466, -12544,
    -12622, -12700, -12777, -12855, -12932, -13009, -13086, -13163, -13240, -13317,
    -13394, -13470, -13547, -13623, -13699, -13775, -13851, -13926, -14002, -14077,
    -14152, -14227, -14302, -14377, -14452, -14527, -14601, -14675, -14749, -14823,
    -14897, -14971, -15044, -15118, -15191, -15264, -15337, -15410, -15482, -15555,
    -15627, -15699, -15771, -15843, -15915, -15986, -16058, -16129, -16200, -16271,
    -16342, -16412, -16483, -16553, -16623, -16693, -16763, -16832, -16902, -16971,
    -17040, -17109, -17178, -17246, -17315, -17383, -17451, -17519, -17587, -17654,
    -17722, -17789, -17856, -17923, -17990, -18056, -18122, -18189, -18255, -18320,
    -18386, -18451, -18517, -18582, -18647, -18711, -18776, -18840, -18904, -18968,
    -19032, -19096, -19159, -19222, -19285, -19348, -19411, -19473, -19535, -19597,
    -19659, -19721, -19782, -19844, -19905, -19966, -20026, -20087, -20147, -20207,
    -20267, -20327, -20386, -20445, -20505, -20563, -20622, -20681, -20739, -20797,
    -20855, -20912, -20970, -21027, -21084, -21141, -21198, -21254, -21310, -21366,
    -21422, -21478, -21533, -21588, -21643, -21698, -21752, -21807, -21861, -21915,
    -21968, -22022, -22075, -22128, -22181, -22233, -22285, -22338, -22389, -22441,
    -22493, -22544, -22595, -22646, -22696, -22747, -22797, -22847, -22896, -22946,
    -22995, -23044, -23093, -23141, -23189, -23237, -23285, -23333, -23380, -23427,
    -23474, -23521, -23567, -23614, -23660, -23705, -23751, -23796, -23841, -23886,
    -23931, -23975, -24019, -24063, -24107, -24150, -24193, -24236, -24279, -24321,
    -24363, -24405, -24447, -24489, -24530, -24571, -24612, -24652, -24692, -24732,
    -24772, -24812, -24851, -24890, -24929, -24967, -25006, -25044, -25082, -25119,
    -25156, -25193, -25230, -25267, -25303, -25339, -25375, -25411, -25446, -25481,
    -25516, -25550, -25585, -25619, -25653, -25686, -25719, -25752, -25785, -25818,
    -25850, -25882, -25914, -25945, -25977, -26008, -26038, -26069, -26099, -26129,
    -26159, -26188, -26217, -26246, -26275, -26304, -26332, -26360, -26387, -26415,
    -26442, -26469, -26495, -26522, -26548, -26573, -26599, -26624, -26649, -26674,
    -26699, -26723, -26747, -26770, -26794, -26817, -26840, -26863, -26885, -26907,
    -26929, -26951, -26972, -26993, -27014, -27034, -27055, -27075, -27094, -27114,
    -27133, -27152, -27170, -27189, -27207, -27225, -27242, -27260, -27277, -27294,
    -27310, -27326, -27342, -27358, -27373, -27388, -27403, -27418, -27432, -27446,
    -27460, -27474, -27487, -27500, -27513, -27525, -27537, -27549, -27561, -27572,
    -27583, -27594, -27605, -27615, -27625, -27635, -27644, -27653, -27662, -27671,
    -27679, -27687, -27695, -27703, -27710, -27717, -27724, -27730, -27736, -27742,
    -27748, -27753, -27758, -27763, -27767, -27772, -27776, -27779, -27783, -27786,
    -27789, -27791, -27794, -27796, -27798, -27799, -27800, -27801, -27802, -27802,
    -27802, -27802, -27802, -27801, -27800, -27799, -27798, -27796, -27794, -27791,
    -27789, -27786, -27783, -27779, -27776, -27772, -27767, -27763, -27758, -27753,
    -27748, -27742, -27736, -27730, -27724, -27717, -27710, -27703, -27695, -27687,
    -27679, -27671, -27662, -27653, -27644, -27635, -27625, -27615, -27605, -27594,
    -27583, -27572, -27561, -27549, -27537, -27525, -27513, -27500, -27487, -27474,
    -27460, -27446, -27432, -27418, -27403, -27388, -27373, -27358, -27342, -27326,
    -27310, -27294, -27277, -27260, -27242, -27225, -27207, -27189, -27170, -27152,
    -27133, -27114, -27094, -27075, -27055, -27034, -27014, -26993, -26972, -26951,
    -26929, -26907, -26885, -26863, -26840, -26817, -26794, -26770, -26747, -26723,
    -26699, -26674, -26649, -26624, -26599, -26573, -26548, -26522, -26495, -26469,
    -26442, -26415, -26387, -26360, -26332, -26304, -26275, -26246, -26217, -26188,
    -26159, -26129, -26099, -26069, -26038, -26008, -25977, -25945, -25914, -25882,
    -25850, -25818, -25785, -25752, -25719, -25686, -25653, -25619, -25585, -25550,
    -25516, -25481, -25446, -25411, -25375, -25339, -25303, -25267, -25230, -25193,
    -25156, -25119, -25082, -25044, -25006, -24967, -24929, -24890, -24851, -24812,
    -24772, -24732, -24692, -24652, -24612, -24571, -24530, -24489, -24447, -24405,
    -24363, -24321, -24279, -24236, -24193, -24150, -24107, -24063, -24019, -23975,
    -23931, -23886, -23841, -23796, -23751, -23705, -23660, -23614, -23567, -23521,
    -23474, -23427, -23380, -23333, -23285, -23237, -23189, -23141, -23093, -23044,
    -22995, -22946, -22896, -22847, -22797, -22747, -22696, -22646, -22595, -22544,
    -22493, -22441, -22389, -22338, -22285, -22233, -22181, -22128, -22075, -22022,
    -21968, -21915, -21861, -21807, -21752, -21698, -21643, -21588, -21533, -21478,
    -21422, -21366, -21310, -21254, -21198, -21141, -21084, -21027, -20970, -20912,
    -20855, -20797, -20739, -20681, -20622, -20563, -20505, -20445, -20386, -20327,
    -20267, -20207, -20147, -20087, -20026, -19966, -19905, -19844, -19782, -19721,
    -19659, -19597, -19535, -19473, -19411, -19348, -19285, -19222, -19159, -19096,
    -19032, -18968, -18904, -18840, -18776, -18711, -18647, -18582, -18517, -18451,
    -18386, -18320, -18255, -18189, -18122, -18056, -17990, -17923, -17856, -17789,
    -17722, -17654, -17587, -17519, -17451, -17383, -17315, -17246, -17178, -17109,
    -17040, -16971, -16902, -16832, -16763, -16693, -16623, -16553, -16483, -16412,
    -16342, -16271, -16200, -16129, -16058, -15986, -15915, -15843, -15771, -15699,
    -15627, -15555, -15482, -15410, -15337, -15264, -15191, -15118, -15044, -14971,
    -14897, -14823, -14749, -14675, -14601, -14527, -14452, -14377, -14302, -14227,
    -14152, -14077, -14002, -13926, -13851, -13775, -13699, -13623, -13547, -13470,
    -13394, -13317, -13240, -13163, -13086, -13009, -12932, -12855, -12777, -12700,
    -12622, -12544, -12466, -12388, -12310, -12231, -12153, -12074, -11995, -11916,
    -11837, -11758, -11679, -11600, -11520, -11441, -11361, -11281, -11202, -11122,
    -11041, -10961, -10881, -10800, -10720, -10639, -10558, -10478, -10397, -10316,
    -10234, -10153, -10072, -9990,  -9909,  -9827,  -9745,  -9664,  -9582,  -9500,
    -9417,  -9335,  -9253,  -9170,  -9088,  -9005,  -8923,  -8840,  -8757,  -8674,
    -8591,  -8508,  -8425,  -8342,  -8258,  -8175,  -8091,  -8008,  -7924,  -7840,
    -7756,  -7672,  -7588,  -7504,  -7420,  -7336,  -7252,  -7167,  -7083,  -6998,
    -6914,  -6829,  -6744,  -6660,  -6575,  -6490,  -6405,  -6320,  -6235,  -6150,
    -6065,  -5979,  -5894,  -5809,  -5723,  -5638,  -5552,  -5466,  -5381,  -5295,
    -5209,  -5123,  -5038,  -4952,  -4866,  -4780,  -4694,  -4607,  -4521,  -4435,
    -4349,  -4263,  -4176,  -4090,  -4003,  -3917,  -3830,  -3744,  -3657,  -3571,
    -3484,  -3397,  -3311,  -3224,  -3137,  -3050,  -2964,  -2877,  -2790,  -2703,
    -2616,  -2529,  -2442,  -2355,  -2268,  -2181,  -2094,  -2007,  -1920,  -1832,
    -1745,  -1658,  -1571,  -1484,  -1396,  -1309,  -1222,  -1135,  -1047,  -960,
    -873,   -786,   -698,   -611,   -524,   -436,   -349,   -262,   -174,   -87
};
int16_t bob2[BOBMAX]={
    -27803, -27776, -27748, -27720, -27692, -27664, -27637, -27609, -27581, -27553,
    -27525, -27498, -27470, -27442, -27414, -27386, -27358, -27331, -27303, -27275,
    -27247, -27219, -27192, -27164, -27136, -27108, -27080, -27052, -27025, -26997,
    -26969, -26941, -26913, -26886, -26858, -26830, -26802, -26774, -26746, -26719,
    -26691, -26663, -26635, -26607, -26580, -26552, -26524, -26496, -26468, -26440,
    -26413, -26385, -26357, -26329, -26301, -26274, -26246, -26218, -26190, -26162,
    -26134, -26107, -26079, -26051, -26023, -25995, -25968, -25940, -25912, -25884,
    -25856, -25828, -25801, -25773, -25745, -25717, -25689, -25662, -25634, -25606,
    -25578, -25550, -25523, -25495, -25467, -25439, -25411, -25383, -25356, -25328,
    -25300, -25272, -25244, -25217, -25189, -25161, -25133, -25105, -25077, -25050,
    -25022, -24994, -24966, -24938, -24911, -24883, -24855, -24827, -24799, -24771,
    -24744, -24716, -24688, -24660, -24632, -24605, -24577, -24549, -24521, -24493,
    -24465, -24438, -24410, -24382, -24354, -24326, -24299, -24271, -24243, -24215,
    -24187, -24159, -24132, -24104, -24076, -24048, -24020, -23993, -23965, -23937,
    -23909, -23881, -23853, -23826, -23798, -23770, -23742, -23714, -23687, -23659,
    -23631, -23603, -23575, -23548, -23520, -23492, -23464, -23436, -23408, -23381,
    -23353, -23325, -23297, -23269, -23242, -23214, -23186, -23158, -23130, -23102,
    -23075, -23047, -23019, -22991, -22963, -22936, -22908, -22880, -22852, -22824,
    -22796, -22769, -22741, -22713, -22685, -22657, -22630, -22602, -22574, -22546,
    -22518, -22490, -22463, -22435, -22407, -22379, -22351, -22324, -22296, -22268,
    -22240, -22212, -22184, -22157, -22129, -22101, -22073, -22045, -22018, -21990,
    -21962, -21934, -21906, -21878, -21851, -21823, -21795, -21767, -21739, -21712,
    -21684, -21656, -21628, -21600, -21573, -21545, -21517, -21489, -21461, -21433,
    -21406, -21378, -21350, -21322, -21294, -21267, -21239, -21211, -21183, -21155,
    -21127, -21100, -21072, -21044, -21016, -20988, -20961, -20933, -20905, -20877,
    -20849, -20821, -20794, -20766, -20738, -20710, -20682, -20655, -20627, -20599,
    -20571, -20543, -20515, -20488, -20460, -20432, -20404, -20376, -20349, -20321,
    -20293, -20265, -20237, -20209, -20182, -20154, -20126, -20098, -20070, -20043,
    -20015, -19987, -19959, -19931, -19903, -19876, -19848, -19820, -19792, -19764,
    -19737, -19709, -19681, -19653, -19625, -19598, -19570, -19542, -19514, -19486,
    -19458, -19431, -19403, -19375, -19347, -19319, -19292, -19264, -19236, -19208,
    -19180, -19152, -19125, -19097, -19069, -19041, -19013, -18986, -18958, -18930,
    -18902, -18874, -18846, -18819, -18791, -18763, -18735, -18707, -18680, -18652,
    -18624, -18596, -18568, -18540, -18513, -18485, -18457, -18429, -18401, -18374,
    -18346, -18318, -18290, -18262, -18234, -18207, -18179, -18151, -18123, -18095,
    -18068, -18040, -18012, -17984, -17956, -17928, -17901, -17873, -17845, -17817,
    -17789, -17762, -17734, -17706, -17678, -17650, -17623, -17595, -17567, -17539,
    -17511, -17483, -17456, -17428, -17400, -17372, -17344, -17317, -17289, -17261,
    -17233, -17205, -17177, -17150, -17122, -17094, -17066, -17038, -17011, -16983,
    -16955, -16927, -16899, -16871, -16844, -16816, -16788, -16760, -16732, -16705,
    -16677, -16649, -16621, -16593, -16565, -16538, -16510, -16482, -16454, -16426,
    -16399, -16371, -16343, -16315, -16287, -16259, -16232, -16204, -16176, -16148,
    -16120, -16093, -16065, -16037, -16009, -15981, -15953, -15926, -15898, -15870,
    -15842, -15814, -15787, -15759, -15731, -15703, -15675, -15648, -15620, -15592,
    -15564, -15536, -15508, -15481, -15453, -15425, -15397, -15369, -15342, -15314,
    -15286, -15258, -15230, -15202, -15175, -15147, -15119, -15091, -15063, -15036,
    -15008, -14980, -14952, -14924, -14896, -14869, -14841, -14813, -14785, -14757,
    -14730, -14702, -14674, -14646, -14618, -14590, -14563, -14535, -14507, -14479,
    -14451, -14424, -14396, -14368, -14340, -14312, -14284, -14257, -14229, -14201,
    -14173, -14145, -14118, -14090, -14062, -14034, -14006, -13978, -13951, -13923,
    -13895, -13867, -13839, -13812, -13784, -13756, -13728, -13700, -13673, -13645,
    -13617, -13589, -13561, -13533, -13506, -13478, -13450, -13422, -13394, -13367,
    -13339, -13311, -13283, -13255, -13227, -13200, -13172, -13144, -13116, -13088,
    -13061, -13033, -13005, -12977, -12949, -12921, -12894, -12866, -12838, -12810,
    -12782, -12755, -12727, -12699, -12671, -12643, -12615, -12588, -12560, -12532,
    -12504, -12476, -12449, -12421, -12393, -12365, -12337, -12309, -12282, -12254,
    -12226, -12198, -12170, -12143, -12115, -12087, -12059, -12031, -12003, -11976,
    -11948, -11920, -11892, -11864, -11837, -11809, -11781, -11753, -11725, -11698,
    -11670, -11642, -11614, -11586, -11558, -11531, -11503, -11475, -11447, -11419,
    -11392, -11364, -11336, -11308, -11280, -11252, -11225, -11197, -11169, -11141,
    -11113, -11086, -11058, -11030, -11002, -10974, -10946, -10919, -10891, -10863,
    -10835, -10807, -10780, -10752, -10724, -10696, -10668, -10640, -10613, -10585,
    -10557, -10529, -10501, -10474, -10446, -10418, -10390, -10362, -10334, -10307,
    -10279, -10251, -10223, -10195, -10168, -10140, -10112, -10084, -10056, -10028,
    -10001, -9973,  -9945,  -9917,  -9889,  -9862,  -9834,  -9806,  -9778,  -9750,
    -9723,  -9695,  -9667,  -9639,  -9611,  -9583,  -9556,  -9528,  -9500,  -9472,
    -9444,  -9417,  -9389,  -9361,  -9333,  -9305,  -9277,  -9250,  -9222,  -9194,
    -9166,  -9138,  -9111,  -9083,  -9055,  -9027,  -8999,  -8971,  -8944,  -8916,
    -8888,  -8860,  -8832,  -8805,  -8777,  -8749,  -8721,  -8693,  -8665,  -8638,
    -8610,  -8582,  -8554,  -8526,  -8499,  -8471,  -8443,  -8415,  -8387,  -8359,
    -8332,  -8304,  -8276,  -8248,  -8220,  -8193,  -8165,  -8137,  -8109,  -8081,
    -8053,  -8026,  -7998,  -7970,  -7942,  -7914,  -7887,  -7859,  -7831,  -7803,
    -7775,  -7748,  -7720,  -7692,  -7664,  -7636,  -7608,  -7581,  -7553,  -7525,
    -7497,  -7469,  -7442,  -7414,  -7386,  -7358,  -7330,  -7302,  -7275,  -7247,
    -7219,  -7191,  -7163,  -7136,  -7108,  -7080,  -7052,  -7024,  -6996,  -6969,
    -6941,  -6913,  -6885,  -6857,  -6830,  -6802,  -6774,  -6746,  -6718,  -6690,
    -6663,  -6635,  -6607,  -6579,  -6551,  -6524,  -6496,  -6468,  -6440,  -6412,
    -6384,  -6357,  -6329,  -6301,  -6273,  -6245,  -6218,  -6190,  -6162,  -6134,
    -6106,  -6078,  -6051,  -6023,  -5995,  -5967,  -5939,  -5912,  -5884,  -5856,
    -5828,  -5800,  -5773,  -5745,  -5717,  -5689,  -5661,  -5633,  -5606,  -5578,
    -5550,  -5522,  -5494,  -5467,  -5439,  -5411,  -5383,  -5355,  -5327,  -5300,
    -5272,  -5244,  -5216,  -5188,  -5161,  -5133,  -5105,  -5077,  -5049,  -5021,
    -4994,  -4966,  -4938,  -4910,  -4882,  -4855,  -4827,  -4799,  -4771,  -4743,
    -4715,  -4688,  -4660,  -4632,  -4604,  -4576,  -4549,  -4521,  -4493,  -4465,
    -4437,  -4409,  -4382,  -4354,  -4326,  -4298,  -4270,  -4243,  -4215,  -4187,
    -4159,  -4131,  -4103,  -4076,  -4048,  -4020,  -3992,  -3964,  -3937,  -3909,
    -3881,  -3853,  -3825,  -3798,  -3770,  -3742,  -3714,  -3686,  -3658,  -3631,
    -3603,  -3575,  -3547,  -3519,  -3492,  -3464,  -3436,  -3408,  -3380,  -3352,
    -3325,  -3297,  -3269,  -3241,  -3213,  -3186,  -3158,  -3130,  -3102,  -3074,
    -3046,  -3019,  -2991,  -2963,  -2935,  -2907,  -2880,  -2852,  -2824,  -2796,
    -2768,  -2740,  -2713,  -2685,  -2657,  -2629,  -2601,  -2574,  -2546,  -2518,
    -2490,  -2462,  -2434,  -2407,  -2379,  -2351,  -2323,  -2295,  -2268,  -2240,
    -2212,  -2184,  -2156,  -2128,  -2101,  -2073,  -2045,  -2017,  -1989,  -1962,
    -1934,  -1906,  -1878,  -1850,  -1823,  -1795,  -1767,  -1739,  -1711,  -1683,
    -1656,  -1628,  -1600,  -1572,  -1544,  -1517,  -1489,  -1461,  -1433,  -1405,
    -1377,  -1350,  -1322,  -1294,  -1266,  -1238,  -1211,  -1183,  -1155,  -1127,
    -1099,  -1071,  -1044,  -1016,  -988,   -960,   -932,   -905,   -877,   -849,
    -821,   -793,   -765,   -738,   -710,   -682,   -654,   -626,   -599,   -571,
    -543,   -515,   -487,   -459,   -432,   -404,   -376,   -348,   -320,   -293,
    -265,   -237,   -209,   -181,   -153,   -126,   -98,    -70,    -42,    -14,
    13,     41,     69,     97,     125,    152,    180,    208,    236,    264,
    292,    319,    347,    375,    403,    431,    458,    486,    514,    542,
    570,    598,    625,    653,    681,    709,    737,    764,    792,    820,
    848,    876,    904,    931,    959,    987,    1015,   1043,   1070,   1098,
    1126,   1154,   1182,   1210,   1237,   1265,   1293,   1321,   1349,   1376,
    1404,   1432,   1460,   1488,   1516,   1543,   1571,   1599,   1627,   1655,
    1682,   1710,   1738,   1766,   1794,   1822,   1849,   1877,   1905,   1933,
    1961,   1988,   2016,   2044,   2072,   2100,   2127,   2155,   2183,   2211,
    2239,   2267,   2294,   2322,   2350,   2378,   2406,   2433,   2461,   2489,
    2517,   2545,   2573,   2600,   2628,   2656,   2684,   2712,   2739,   2767,
    2795,   2823,   2851,   2879,   2906,   2934,   2962,   2990,   3018,   3045,
    3073,   3101,   3129,   3157,   3185,   3212,   3240,   3268,   3296,   3324,
    3351,   3379,   3407,   3435,   3463,   3491,   3518,   3546,   3574,   3602,
    3630,   3657,   3685,   3713,   3741,   3769,   3797,   3824,   3852,   3880,
    3908,   3936,   3963,   3991,   4019,   4047,   4075,   4102,   4130,   4158,
    4186,   4214,   4242,   4269,   4297,   4325,   4353,   4381,   4408,   4436,
    4464,   4492,   4520,   4548,   4575,   4603,   4631,   4659,   4687,   4714,
    4742,   4770,   4798,   4826,   4854,   4881,   4909,   4937,   4965,   4993,
    5020,   5048,   5076,   5104,   5132,   5160,   5187,   5215,   5243,   5271,
    5299,   5326,   5354,   5382,   5410,   5438,   5466,   5493,   5521,   5549,
    5577,   5605,   5632,   5660,   5688,   5716,   5744,   5772,   5799,   5827,
    5855,   5883,   5911,   5938,   5966,   5994,   6022,   6050,   6077,   6105,
    6133,   6161,   6189,   6217,   6244,   6272,   6300,   6328,   6356,   6383,
    6411,   6439,   6467,   6495,   6523,   6550,   6578,   6606,   6634,   6662,
    6689,   6717,   6745,   6773,   6801,   6829,   6856,   6884,   6912,   6940,
    6968,   6995,   7023,   7051,   7079,   7107,   7135,   7162,   7190,   7218,
    7246,   7274,   7301,   7329,   7357,   7385,   7413,   7441,   7468,   7496,
    7524,   7552,   7580,   7607,   7635,   7663,   7691,   7719,   7747,   7774,
    7802,   7830,   7858,   7886,   7913,   7941,   7969,   7997,   8025,   8052,
    8080,   8108,   8136,   8164,   8192,   8219,   8247,   8275,   8303,   8331,
    8358,   8386,   8414,   8442,   8470,   8498,   8525,   8553,   8581,   8609,
    8637,   8664,   8692,   8720,   8748,   8776,   8804,   8831,   8859,   8887,
    8915,   8943,   8970,   8998,   9026,   9054,   9082,   9110,   9137,   9165,
    9193,   9221,   9249,   9276,   9304,   9332,   9360,   9388,   9416,   9443,
    9471,   9499,   9527,   9555,   9582,   9610,   9638,   9666,   9694,   9722,
    9749,   9777,   9805,   9833,   9861,   9888,   9916,   9944,   9972,   10000,
    10027,  10055,  10083,  10111,  10139,  10167,  10194,  10222,  10250,  10278,
    10306,  10333,  10361,  10389,  10417,  10445,  10473,  10500,  10528,  10556,
    10584,  10612,  10639,  10667,  10695,  10723,  10751,  10779,  10806,  10834,
    10862,  10890,  10918,  10945,  10973,  11001,  11029,  11057,  11085,  11112,
    11140,  11168,  11196,  11224,  11251,  11279,  11307,  11335,  11363,  11391,
    11418,  11446,  11474,  11502,  11530,  11557,  11585,  11613,  11641,  11669,
    11697,  11724,  11752,  11780,  11808,  11836,  11863,  11891,  11919,  11947,
    11975,  12002,  12030,  12058,  12086,  12114,  12142,  12169,  12197,  12225,
    12253,  12281,  12308,  12336,  12364,  12392,  12420,  12448,  12475,  12503,
    12531,  12559,  12587,  12614,  12642,  12670,  12698,  12726,  12754,  12781,
    12809,  12837,  12865,  12893,  12920,  12948,  12976,  13004,  13032,  13060,
    13087,  13115,  13143,  13171,  13199,  13226,  13254,  13282,  13310,  13338,
    13366,  13393,  13421,  13449,  13477,  13505,  13532,  13560,  13588,  13616,
    13644,  13672,  13699,  13727,  13755,  13783,  13811,  13838,  13866,  13894,
    13922,  13950,  13977,  14005,  14033,  14061,  14089,  14117,  14144,  14172,
    14200,  14228,  14256,  14283,  14311,  14339,  14367,  14395,  14423,  14450,
    14478,  14506,  14534,  14562,  14589,  14617,  14645,  14673,  14701,  14729,
    14756,  14784,  14812,  14840,  14868,  14895,  14923,  14951,  14979,  15007,
    15035,  15062,  15090,  15118,  15146,  15174,  15201,  15229,  15257,  15285,
    15313,  15341,  15368,  15396,  15424,  15452,  15480,  15507,  15535,  15563,
    15591,  15619,  15647,  15674,  15702,  15730,  15758,  15786,  15813,  15841,
    15869,  15897,  15925,  15952,  15980,  16008,  16036,  16064,  16092,  16119,
    16147,  16175,  16203,  16231,  16258,  16286,  16314,  16342,  16370,  16398,
    16425,  16453,  16481,  16509,  16537,  16564,  16592,  16620,  16648,  16676,
    16704,  16731,  16759,  16787,  16815,  16843,  16870,  16898,  16926,  16954,
    16982,  17010,  17037,  17065,  17093,  17121,  17149,  17176,  17204,  17232,
    17260,  17288,  17316,  17343,  17371,  17399,  17427,  17455,  17482,  17510,
    17538,  17566,  17594,  17622,  17649,  17677,  17705,  17733,  17761,  17788,
    17816,  17844,  17872,  17900,  17927,  17955,  17983,  18011,  18039,  18067,
    18094,  18122,  18150,  18178,  18206,  18233,  18261,  18289,  18317,  18345,
    18373,  18400,  18428,  18456,  18484,  18512,  18539,  18567,  18595,  18623,
    18651,  18679,  18706,  18734,  18762,  18790,  18818,  18845,  18873,  18901,
    18929,  18957,  18985,  19012,  19040,  19068,  19096,  19124,  19151,  19179,
    19207,  19235,  19263,  19291,  19318,  19346,  19374,  19402,  19430,  19457,
    19485,  19513,  19541,  19569,  19597,  19624,  19652,  19680,  19708,  19736,
    19763,  19791,  19819,  19847,  19875,  19902,  19930,  19958,  19986,  20014,
    20042,  20069,  20097,  20125,  20153,  20181,  20208,  20236,  20264,  20292,
    20320,  20348,  20375,  20403,  20431,  20459,  20487,  20514,  20542,  20570,
    20598,  20626,  20654,  20681,  20709,  20737,  20765,  20793,  20820,  20848,
    20876,  20904,  20932,  20960,  20987,  21015,  21043,  21071,  21099,  21126,
    21154,  21182,  21210,  21238,  21266,  21293,  21321,  21349,  21377,  21405,
    21432,  21460,  21488,  21516,  21544,  21572,  21599,  21627,  21655,  21683,
    21711,  21738,  21766,  21794,  21822,  21850,  21877,  21905,  21933,  21961,
    21989,  22017,  22044,  22072,  22100,  22128,  22156,  22183,  22211,  22239,
    22267,  22295,  22323,  22350,  22378,  22406,  22434,  22462,  22489,  22517,
    22545,  22573,  22601,  22629,  22656,  22684,  22712,  22740,  22768,  22795,
    22823,  22851,  22879,  22907,  22935,  22962,  22990,  23018,  23046,  23074,
    23101,  23129,  23157,  23185,  23213,  23241,  23268,  23296,  23324,  23352,
    23380,  23407,  23435,  23463,  23491,  23519,  23547,  23574,  23602,  23630,
    23658,  23686,  23713,  23741,  23769,  23797,  23825,  23852,  23880,  23908,
    23936,  23964,  23992,  24019,  24047,  24075,  24103,  24131,  24158,  24186,
    24214,  24242,  24270,  24298,  24325,  24353,  24381,  24409,  24437,  24464,
    24492,  24520,  24548,  24576,  24604,  24631,  24659,  24687,  24715,  24743,
    24770,  24798,  24826,  24854,  24882,  24910,  24937,  24965,  24993,  25021,
    25049,  25076,  25104,  25132,  25160,  25188,  25216,  25243,  25271,  25299,
    25327,  25355,  25382,  25410,  25438,  25466,  25494,  25522,  25549,  25577,
    25605,  25633,  25661,  25688,  25716,  25744,  25772,  25800,  25827,  25855,
    25883,  25911,  25939,  25967,  25994,  26022,  26050,  26078,  26106,  26133,
    26161,  26189,  26217,  26245,  26273,  26300,  26328,  26356,  26384,  26412,
    26439,  26467,  26495,  26523,  26551,  26579,  26606,  26634,  26662,  26690,
    26718,  26745,  26773,  26801,  26829,  26857,  26885,  26912,  26940,  26968,
    26996,  27024,  27051,  27079,  27107,  27135,  27163,  27191,  27218,  27246,
    27274,  27302,  27330,  27357,  27385,  27413,  27441,  27469,  27497,  27524,
    27552,  27580,  27608,  27636,  27663,  27691,  27719,  27747,  27775,  27803
};
volatile uint_fast32_t increment[VOICEM] = {0};    // 52.2 * freq
volatile uint_fast32_t counter[VOICEM] = {0};      // position in LUT
volatile int_fast8_t volume[VOICEM] = {0};         // 0 - voice_number

static int_fast32_t bobMax = BOBMAX << 10;
static int_fast8_t voice_number = 255;      // 255 - 0 available voice slots
static int_fast8_t voice_counter = 0;       // 0 - VOICEM number of voices

/*
    typedef enum _mod{
        none = 0,
        lfo1 = 1,
        lfo2 = 2,
        noiser = 3,
        note = 4,
        speed = 5,
        pitch_w = 6,
        mod_w = 7,
        slider1 = 8,
        slider2 = 9,
        slider3 = 10,
        slider4 = 11,
        slider5 = 12
    } MODIFIER;
    typedef enum _shape{
        sinusoid = 0,
        triangle = 1,
        square = 2,
        sawtooth = 3,
        inv_sawtooth = 4
    } SHAPE;
    typedef enum _oscm{
        frees = 0,
        retriggers = 1
    } O_MODE;

    typedef enum _state{
        off_t = 0,
        on_t = 1
    } STATE;
    static int8_t volume = 50;  // 0 ... 99
    static enum _stereo{
        l_r,
        l_only,
        r_only
    } stereo = l_r;

    static uint8_t osc_count_limit = 61;
    static uint8_t max_osc_mode = frees;

    // oct_trans - piano has 9 octaves, our synth has 5, it starts at the second already - 0 ... (4 * 12) = 48
    static uint8_t oct_trans = 2; // 2 * 12
    static uint8_t note_trans = 0; // 2 * 12
    static uint8_t mixer1 = 50; // mixer's first channel
    static uint8_t mixer2 = 50; // mixer's second channel

    static SHAPE osc1_shape = sinusoid;
    static uint8_t osc1_osc_count = 0; // 0 ... 5(?)
    //static SO_MODE osc1_osc_mode = harmonic;              all sub oscillators are harmonic
    //static uint8_t osc1_osc_unison = 0; // 0 ... 100
    static int8_t osc1_trans = 0;  // transpose -24 ... 24
    static int8_t osc1_cent = 0;   // 0 ... 100
    static MODIFIER osc1_trans_mod = none; // modifier for osc trans
    static MODIFIER osc1_cent_mod = none;  // modifier for osc cent

    static SHAPE osc2_shape = sinusoid;
    static uint8_t osc2_osc_count = 0; // 0 ... 5(?)
    //static SO_MODE osc2_osc_mode = harmonic;              all sub oscillators are harmonic
    //static uint8_t osc2_osc_unison = 0; // 0 ... 100
    static int8_t osc2_trans = 0;  // transpose -24 ... 24
    static int8_t osc2_cent = 0;   // 0 ... 100
    static MODIFIER osc2_trans_mod = none; // modifier for osc trans
    static MODIFIER osc2_cent_mod = none;  // modifier for osc cent

    static uint16_t adsr_a = 0;    // 0 ... 10000 ms
    static uint16_t adsr_d = 0;    // 0 ... 10000 ms
    static uint16_t adsr_s = 0;    // 0 ... 10000 ms
    static uint16_t adsr_sl = 0;   // 0 ... 100%
    static uint16_t adsr_r = 1;    // 1 ... 10000 ms
    static MODIFIER adsr_a_mod = none;    // modifier for adsr A parameter
    static MODIFIER adsr_d_mod = none;    // modifier for adsr D parameter
    static MODIFIER adsr_s_mod = none;    // modifier for adsr S parameter
    static MODIFIER adsr_sl_mod = none;   // modifier for adsr SL parameter
    static MODIFIER adsr_r_mod = none;    // modifier for adsr R parameter

    static uint8_t amp_pw = 0;  // 0 ... 99
    static uint8_t amp_mw = 0;  // 0 ... 99
    static uint8_t amp_kn = 0;  // 0 ... 99
    static uint8_t amp_ks = 0;  // 0 ... 99
    static uint8_t amp_s1 = 0;  // 0 ... 99
    static uint8_t amp_s2 = 0;  // 0 ... 99
    static uint8_t amp_s3 = 0;  // 0 ... 99
    static uint8_t amp_s4 = 0;  // 0 ... 99
    static uint8_t amp_s5 = 0;  // 0 ... 99

    static STATE lfo1_state = off_t; // 0 - off, 1 - on
    static O_MODE lfo1_mode = frees;
    static SHAPE lfo1_shape = sinusoid;
    static uint8_t lfo1_amp = 0;   // 0 ... 100
    static uint8_t lfo1_freq = 0;  // 0 ... 250
    static MODIFIER lfo1_amp_mod = none;  // modifier for lfo1 amplitude
    static MODIFIER lfo1_freq_mod = none; // modifier for lfo1 frequency

    static STATE lfo2_state = off_t; // 0 - off, 1 - on
    static O_MODE lfo2_mode = frees;
    static SHAPE lfo2_shape = sinusoid;
    static uint8_t lfo2_amp = 0;   // 0 ... 100
    static uint8_t lfo2_freq = 0;  // 0 ... 250
    static MODIFIER lfo2_amp_mod = none;  // modifier for lfo2 amplitude
    static MODIFIER lfo2_freq_mod = none; // modifier for lfo2 frequency

    // MOD ENV variables
    static STATE me_state = off_t;      // 0 - off, 1 - on
    static uint16_t me_a = 0;       // 0 ... 10000 ms
    static uint16_t me_d = 0;       // 0 ... 10000 ms
    static uint16_t me_s = 0;       // 0 ... 10000 ms
    static uint16_t me_sl = 0;      // 0 ... 100%
    static uint16_t me_r = 1;       // 1 ... 10000 ms
    static MODIFIER me_a_mod = none;    // modifier for MOD ENV A parameter
    static MODIFIER me_d_mod = none;    // modifier for MOD ENV D parameter
    static MODIFIER me_s_mod = none;    // modifier for MOD ENV S parameter
    static MODIFIER me_sl_mod = none;   // modifier for MOD ENV SL parameter
    static MODIFIER me_r_mod = none;    // modifier for MOD ENV R parameter
*/

void addVoice(uint16_t frequency, uint16_t vol, uint16_t number){
    if((voice_number > 0) && (voice_counter < VOICEM)){
        volume[number] = vol;
        voice_number -= vol;
        //voices[number].counter = 0;
        increment[number] = 256 * frequency / 5;
        voice_counter++;
    }
}

void removeVoice(uint16_t number){
    if(voice_counter > 0){
        voice_number += volume[number];
        volume[number] = 0;
        increment[number] = 0;
        counter[number] =0;
        voice_counter--;
    }
}

void task0(void){ // can't use float in ISR
    int_fast16_t out_r = 0, out_l = 0;
    uint_fast8_t aux = 0;
    uint_fast32_t localCounter = 0;

    for(aux = 0; aux < VOICEM; aux++){
        localCounter = counter[aux];
        localCounter += increment[aux];
        if(localCounter >= bobMax)
            localCounter -= bobMax;
        out_r += bob[localCounter >> 10] * volume[aux];
        out_l += bob2[localCounter >> 10] * volume[aux];
        counter[aux] = localCounter;
    }

    i2s_output(out_r, out_l);  // R - L
}

void task1(void){
    volatile static uint_fast32_t counter = 0;
    volatile static uint_fast8_t led = 0;

    uint8_t uart_buffer = 0;
    uint8_t uart_count = 0;

    if(counter < 200)
        counter++;
    else{
        if(led){
            led = 0;
            gpio_set_level(LEDPIN, 0);
        }
        else{
            led = 1;
            gpio_set_level(LEDPIN, 1);
        }
        counter = 0;
    }

    uart_count = serial1_read(&uart_buffer, 1);
    if(uart_count != 0){
        serial0_write_hex(uart_buffer);
        serial0_new_line();
    }
}

/* all core 1 operations will be executed in task1()
void core1_loop(void){
    vTaskDelay(1);
}
*/

void task_init(void){
    int32_t aux = 0;

    for(aux = 0; aux < BOBMAX; aux++){
        bob[aux] /= 255;
        bob2[aux] /= 255;
    }
    addVoice(650, 255, 0);
}
