#include "task.h"

// DDS main variables

int16_t lut_sinuso[LUTSIZE] = {
     0,    102,    205,    308,    411,    514,    617,    720,    823,    926,   1029,   1132,   1234,   1337,   1440,   1543,   1646,   1749,   1851,   1954,
  2057,   2160,   2262,   2365,   2468,   2570,   2673,   2776,   2878,   2981,   3083,   3186,   3288,   3390,   3493,   3595,   3697,   3800,   3902,   4004,
  4106,   4208,   4310,   4412,   4514,   4616,   4718,   4820,   4922,   5024,   5125,   5227,   5329,   5430,   5532,   5633,   5734,   5836,   5937,   6038,
  6139,   6241,   6342,   6442,   6543,   6644,   6745,   6846,   6946,   7047,   7147,   7248,   7348,   7448,   7549,   7649,   7749,   7849,   7949,   8049,
  8148,   8248,   8348,   8447,   8546,   8646,   8745,   8844,   8943,   9042,   9141,   9240,   9339,   9437,   9536,   9634,   9733,   9831,   9929,  10027,
 10125,  10223,  10321,  10418,  10516,  10613,  10711,  10808,  10905,  11002,  11099,  11196,  11292,  11389,  11485,  11582,  11678,  11774,  11870,  11966,
 12062,  12157,  12253,  12348,  12444,  12539,  12634,  12729,  12824,  12918,  13013,  13107,  13202,  13296,  13390,  13484,  13577,  13671,  13764,  13858,
 13951,  14044,  14137,  14230,  14322,  14415,  14507,  14600,  14692,  14784,  14875,  14967,  15059,  15150,  15241,  15332,  15423,  15514,  15604,  15695,
 15785,  15875,  15965,  16055,  16145,  16234,  16324,  16413,  16502,  16591,  16679,  16768,  16856,  16944,  17032,  17120,  17208,  17295,  17383,  17470,
 17557,  17644,  17730,  17817,  17903,  17989,  18075,  18161,  18247,  18332,  18417,  18502,  18587,  18672,  18756,  18841,  18925,  19009,  19093,  19176,
 19259,  19343,  19426,  19508,  19591,  19673,  19756,  19838,  19920,  20001,  20083,  20164,  20245,  20326,  20406,  20487,  20567,  20647,  20727,  20807,
 20886,  20965,  21044,  21123,  21202,  21280,  21358,  21436,  21514,  21591,  21669,  21746,  21823,  21899,  21976,  22052,  22128,  22204,  22280,  22355,
 22430,  22505,  22580,  22654,  22728,  22802,  22876,  22950,  23023,  23096,  23169,  23242,  23314,  23387,  23459,  23530,  23602,  23673,  23744,  23815,
 23886,  23956,  24026,  24096,  24166,  24235,  24304,  24373,  24442,  24510,  24578,  24646,  24714,  24782,  24849,  24916,  24982,  25049,  25115,  25181,
 25247,  25312,  25378,  25443,  25507,  25572,  25636,  25700,  25764,  25827,  25891,  25953,  26016,  26079,  26141,  26203,  26264,  26326,  26387,  26448,
 26509,  26569,  26629,  26689,  26748,  26808,  26867,  26926,  26984,  27042,  27100,  27158,  27216,  27273,  27330,  27386,  27443,  27499,  27555,  27610,
 27666,  27721,  27775,  27830,  27884,  27938,  27992,  28045,  28098,  28151,  28203,  28256,  28308,  28359,  28411,  28462,  28513,  28563,  28614,  28664,
 28713,  28763,  28812,  28861,  28910,  28958,  29006,  29054,  29101,  29148,  29195,  29242,  29288,  29334,  29380,  29425,  29470,  29515,  29560,  29604,
 29648,  29692,  29735,  29778,  29821,  29863,  29906,  29948,  29989,  30031,  30072,  30112,  30153,  30193,  30233,  30272,  30312,  30350,  30389,  30427,
 30465,  30503,  30541,  30578,  30615,  30651,  30687,  30723,  30759,  30794,  30829,  30864,  30898,  30933,  30966,  31000,  31033,  31066,  31099,  31131,
 31163,  31194,  31226,  31257,  31288,  31318,  31348,  31378,  31407,  31437,  31465,  31494,  31522,  31550,  31578,  31605,  31632,  31659,  31685,  31711,
 31737,  31763,  31788,  31812,  31837,  31861,  31885,  31909,  31932,  31955,  31977,  32000,  32022,  32043,  32065,  32086,  32106,  32127,  32147,  32167,
 32186,  32205,  32224,  32243,  32261,  32279,  32296,  32313,  32330,  32347,  32363,  32379,  32395,  32410,  32425,  32440,  32454,  32468,  32482,  32495,
 32508,  32521,  32533,  32545,  32557,  32569,  32580,  32591,  32601,  32611,  32621,  32631,  32640,  32649,  32657,  32665,  32673,  32681,  32688,  32695,
 32702,  32708,  32714,  32720,  32725,  32730,  32735,  32739,  32743,  32747,  32750,  32753,  32756,  32759,  32761,  32762,  32764,  32765,  32766,  32766,
 32767,  32766,  32766,  32765,  32764,  32762,  32761,  32759,  32756,  32753,  32750,  32747,  32743,  32739,  32735,  32730,  32725,  32720,  32714,  32708,
 32702,  32695,  32688,  32681,  32673,  32665,  32657,  32649,  32640,  32631,  32621,  32611,  32601,  32591,  32580,  32569,  32557,  32545,  32533,  32521,
 32508,  32495,  32482,  32468,  32454,  32440,  32425,  32410,  32395,  32379,  32363,  32347,  32330,  32313,  32296,  32279,  32261,  32243,  32224,  32205,
 32186,  32167,  32147,  32127,  32106,  32086,  32065,  32043,  32022,  32000,  31977,  31955,  31932,  31909,  31885,  31861,  31837,  31812,  31788,  31763,
 31737,  31711,  31685,  31659,  31632,  31605,  31578,  31550,  31522,  31494,  31465,  31437,  31407,  31378,  31348,  31318,  31288,  31257,  31226,  31194,
 31163,  31131,  31099,  31066,  31033,  31000,  30966,  30933,  30898,  30864,  30829,  30794,  30759,  30723,  30687,  30651,  30615,  30578,  30541,  30503,
 30465,  30427,  30389,  30350,  30312,  30272,  30233,  30193,  30153,  30112,  30072,  30031,  29989,  29948,  29906,  29863,  29821,  29778,  29735,  29692,
 29648,  29604,  29560,  29515,  29470,  29425,  29380,  29334,  29288,  29242,  29195,  29148,  29101,  29054,  29006,  28958,  28910,  28861,  28812,  28763,
 28713,  28664,  28614,  28563,  28513,  28462,  28411,  28359,  28308,  28256,  28203,  28151,  28098,  28045,  27992,  27938,  27884,  27830,  27775,  27721,
 27666,  27610,  27555,  27499,  27443,  27386,  27330,  27273,  27216,  27158,  27100,  27042,  26984,  26926,  26867,  26808,  26748,  26689,  26629,  26569,
 26509,  26448,  26387,  26326,  26264,  26203,  26141,  26079,  26016,  25953,  25891,  25827,  25764,  25700,  25636,  25572,  25507,  25443,  25378,  25312,
 25247,  25181,  25115,  25049,  24982,  24916,  24849,  24782,  24714,  24646,  24578,  24510,  24442,  24373,  24304,  24235,  24166,  24096,  24026,  23956,
 23886,  23815,  23744,  23673,  23602,  23530,  23459,  23387,  23314,  23242,  23169,  23096,  23023,  22950,  22876,  22802,  22728,  22654,  22580,  22505,
 22430,  22355,  22280,  22204,  22128,  22052,  21976,  21899,  21823,  21746,  21669,  21591,  21514,  21436,  21358,  21280,  21202,  21123,  21044,  20965,
 20886,  20807,  20727,  20647,  20567,  20487,  20406,  20326,  20245,  20164,  20083,  20001,  19920,  19838,  19756,  19673,  19591,  19508,  19426,  19343,
 19259,  19176,  19093,  19009,  18925,  18841,  18756,  18672,  18587,  18502,  18417,  18332,  18247,  18161,  18075,  17989,  17903,  17817,  17730,  17644,
 17557,  17470,  17383,  17295,  17208,  17120,  17032,  16944,  16856,  16768,  16679,  16591,  16502,  16413,  16324,  16234,  16145,  16055,  15965,  15875,
 15785,  15695,  15604,  15514,  15423,  15332,  15241,  15150,  15059,  14967,  14875,  14784,  14692,  14600,  14507,  14415,  14322,  14230,  14137,  14044,
 13951,  13858,  13764,  13671,  13577,  13484,  13390,  13296,  13202,  13107,  13013,  12918,  12824,  12729,  12634,  12539,  12444,  12348,  12253,  12157,
 12062,  11966,  11870,  11774,  11678,  11582,  11485,  11389,  11292,  11196,  11099,  11002,  10905,  10808,  10711,  10613,  10516,  10418,  10321,  10223,
 10125,  10027,   9929,   9831,   9733,   9634,   9536,   9437,   9339,   9240,   9141,   9042,   8943,   8844,   8745,   8646,   8546,   8447,   8348,   8248,
  8148,   8049,   7949,   7849,   7749,   7649,   7549,   7448,   7348,   7248,   7147,   7047,   6946,   6846,   6745,   6644,   6543,   6442,   6342,   6241,
  6139,   6038,   5937,   5836,   5734,   5633,   5532,   5430,   5329,   5227,   5125,   5024,   4922,   4820,   4718,   4616,   4514,   4412,   4310,   4208,
  4106,   4004,   3902,   3800,   3697,   3595,   3493,   3390,   3288,   3186,   3083,   2981,   2878,   2776,   2673,   2570,   2468,   2365,   2262,   2160,
  2057,   1954,   1851,   1749,   1646,   1543,   1440,   1337,   1234,   1132,   1029,    926,    823,    720,    617,    514,    411,    308,    205,    102,
     0,   -102,   -205,   -308,   -411,   -514,   -617,   -720,   -823,   -926,  -1029,  -1132,  -1234,  -1337,  -1440,  -1543,  -1646,  -1749,  -1851,  -1954,
 -2057,  -2160,  -2262,  -2365,  -2468,  -2570,  -2673,  -2776,  -2878,  -2981,  -3083,  -3186,  -3288,  -3390,  -3493,  -3595,  -3697,  -3800,  -3902,  -4004,
 -4106,  -4208,  -4310,  -4412,  -4514,  -4616,  -4718,  -4820,  -4922,  -5024,  -5125,  -5227,  -5329,  -5430,  -5532,  -5633,  -5734,  -5836,  -5937,  -6038,
 -6139,  -6241,  -6342,  -6442,  -6543,  -6644,  -6745,  -6846,  -6946,  -7047,  -7147,  -7248,  -7348,  -7448,  -7549,  -7649,  -7749,  -7849,  -7949,  -8049,
 -8148,  -8248,  -8348,  -8447,  -8546,  -8646,  -8745,  -8844,  -8943,  -9042,  -9141,  -9240,  -9339,  -9437,  -9536,  -9634,  -9733,  -9831,  -9929, -10027,
-10125, -10223, -10321, -10418, -10516, -10613, -10711, -10808, -10905, -11002, -11099, -11196, -11292, -11389, -11485, -11582, -11678, -11774, -11870, -11966,
-12062, -12157, -12253, -12348, -12444, -12539, -12634, -12729, -12824, -12918, -13013, -13107, -13202, -13296, -13390, -13484, -13577, -13671, -13764, -13858,
-13951, -14044, -14137, -14230, -14322, -14415, -14507, -14600, -14692, -14784, -14875, -14967, -15059, -15150, -15241, -15332, -15423, -15514, -15604, -15695,
-15785, -15875, -15965, -16055, -16145, -16234, -16324, -16413, -16502, -16591, -16679, -16768, -16856, -16944, -17032, -17120, -17208, -17295, -17383, -17470,
-17557, -17644, -17730, -17817, -17903, -17989, -18075, -18161, -18247, -18332, -18417, -18502, -18587, -18672, -18756, -18841, -18925, -19009, -19093, -19176,
-19259, -19343, -19426, -19508, -19591, -19673, -19756, -19838, -19920, -20001, -20083, -20164, -20245, -20326, -20406, -20487, -20567, -20647, -20727, -20807,
-20886, -20965, -21044, -21123, -21202, -21280, -21358, -21436, -21514, -21591, -21669, -21746, -21823, -21899, -21976, -22052, -22128, -22204, -22280, -22355,
-22430, -22505, -22580, -22654, -22728, -22802, -22876, -22950, -23023, -23096, -23169, -23242, -23314, -23387, -23459, -23530, -23602, -23673, -23744, -23815,
-23886, -23956, -24026, -24096, -24166, -24235, -24304, -24373, -24442, -24510, -24578, -24646, -24714, -24782, -24849, -24916, -24982, -25049, -25115, -25181,
-25247, -25312, -25378, -25443, -25507, -25572, -25636, -25700, -25764, -25827, -25891, -25953, -26016, -26079, -26141, -26203, -26264, -26326, -26387, -26448,
-26509, -26569, -26629, -26689, -26748, -26808, -26867, -26926, -26984, -27042, -27100, -27158, -27216, -27273, -27330, -27386, -27443, -27499, -27555, -27610,
-27666, -27721, -27775, -27830, -27884, -27938, -27992, -28045, -28098, -28151, -28203, -28256, -28308, -28359, -28411, -28462, -28513, -28563, -28614, -28664,
-28713, -28763, -28812, -28861, -28910, -28958, -29006, -29054, -29101, -29148, -29195, -29242, -29288, -29334, -29380, -29425, -29470, -29515, -29560, -29604,
-29648, -29692, -29735, -29778, -29821, -29863, -29906, -29948, -29989, -30031, -30072, -30112, -30153, -30193, -30233, -30272, -30312, -30350, -30389, -30427,
-30465, -30503, -30541, -30578, -30615, -30651, -30687, -30723, -30759, -30794, -30829, -30864, -30898, -30933, -30966, -31000, -31033, -31066, -31099, -31131,
-31163, -31194, -31226, -31257, -31288, -31318, -31348, -31378, -31407, -31437, -31465, -31494, -31522, -31550, -31578, -31605, -31632, -31659, -31685, -31711,
-31737, -31763, -31788, -31812, -31837, -31861, -31885, -31909, -31932, -31955, -31977, -32000, -32022, -32043, -32065, -32086, -32106, -32127, -32147, -32167,
-32186, -32205, -32224, -32243, -32261, -32279, -32296, -32313, -32330, -32347, -32363, -32379, -32395, -32410, -32425, -32440, -32454, -32468, -32482, -32495,
-32508, -32521, -32533, -32545, -32557, -32569, -32580, -32591, -32601, -32611, -32621, -32631, -32640, -32649, -32657, -32665, -32673, -32681, -32688, -32695,
-32702, -32708, -32714, -32720, -32725, -32730, -32735, -32739, -32743, -32747, -32750, -32753, -32756, -32759, -32761, -32762, -32764, -32765, -32766, -32766,
-32767, -32766, -32766, -32765, -32764, -32762, -32761, -32759, -32756, -32753, -32750, -32747, -32743, -32739, -32735, -32730, -32725, -32720, -32714, -32708,
-32702, -32695, -32688, -32681, -32673, -32665, -32657, -32649, -32640, -32631, -32621, -32611, -32601, -32591, -32580, -32569, -32557, -32545, -32533, -32521,
-32508, -32495, -32482, -32468, -32454, -32440, -32425, -32410, -32395, -32379, -32363, -32347, -32330, -32313, -32296, -32279, -32261, -32243, -32224, -32205,
-32186, -32167, -32147, -32127, -32106, -32086, -32065, -32043, -32022, -32000, -31977, -31955, -31932, -31909, -31885, -31861, -31837, -31812, -31788, -31763,
-31737, -31711, -31685, -31659, -31632, -31605, -31578, -31550, -31522, -31494, -31465, -31437, -31407, -31378, -31348, -31318, -31288, -31257, -31226, -31194,
-31163, -31131, -31099, -31066, -31033, -31000, -30966, -30933, -30898, -30864, -30829, -30794, -30759, -30723, -30687, -30651, -30615, -30578, -30541, -30503,
-30465, -30427, -30389, -30350, -30312, -30272, -30233, -30193, -30153, -30112, -30072, -30031, -29989, -29948, -29906, -29863, -29821, -29778, -29735, -29692,
-29648, -29604, -29560, -29515, -29470, -29425, -29380, -29334, -29288, -29242, -29195, -29148, -29101, -29054, -29006, -28958, -28910, -28861, -28812, -28763,
-28713, -28664, -28614, -28563, -28513, -28462, -28411, -28359, -28308, -28256, -28203, -28151, -28098, -28045, -27992, -27938, -27884, -27830, -27775, -27721,
-27666, -27610, -27555, -27499, -27443, -27386, -27330, -27273, -27216, -27158, -27100, -27042, -26984, -26926, -26867, -26808, -26748, -26689, -26629, -26569,
-26509, -26448, -26387, -26326, -26264, -26203, -26141, -26079, -26016, -25953, -25891, -25827, -25764, -25700, -25636, -25572, -25507, -25443, -25378, -25312,
-25247, -25181, -25115, -25049, -24982, -24916, -24849, -24782, -24714, -24646, -24578, -24510, -24442, -24373, -24304, -24235, -24166, -24096, -24026, -23956,
-23886, -23815, -23744, -23673, -23602, -23530, -23459, -23387, -23314, -23242, -23169, -23096, -23023, -22950, -22876, -22802, -22728, -22654, -22580, -22505,
-22430, -22355, -22280, -22204, -22128, -22052, -21976, -21899, -21823, -21746, -21669, -21591, -21514, -21436, -21358, -21280, -21202, -21123, -21044, -20965,
-20886, -20807, -20727, -20647, -20567, -20487, -20406, -20326, -20245, -20164, -20083, -20001, -19920, -19838, -19756, -19673, -19591, -19508, -19426, -19343,
-19259, -19176, -19093, -19009, -18925, -18841, -18756, -18672, -18587, -18502, -18417, -18332, -18247, -18161, -18075, -17989, -17903, -17817, -17730, -17644,
-17557, -17470, -17383, -17295, -17208, -17120, -17032, -16944, -16856, -16768, -16679, -16591, -16502, -16413, -16324, -16234, -16145, -16055, -15965, -15875,
-15785, -15695, -15604, -15514, -15423, -15332, -15241, -15150, -15059, -14967, -14875, -14784, -14692, -14600, -14507, -14415, -14322, -14230, -14137, -14044,
-13951, -13858, -13764, -13671, -13577, -13484, -13390, -13296, -13202, -13107, -13013, -12918, -12824, -12729, -12634, -12539, -12444, -12348, -12253, -12157,
-12062, -11966, -11870, -11774, -11678, -11582, -11485, -11389, -11292, -11196, -11099, -11002, -10905, -10808, -10711, -10613, -10516, -10418, -10321, -10223,
-10125, -10027,  -9929,  -9831,  -9733,  -9634,  -9536,  -9437,  -9339,  -9240,  -9141,  -9042,  -8943,  -8844,  -8745,  -8646,  -8546,  -8447,  -8348,  -8248,
 -8148,  -8049,  -7949,  -7849,  -7749,  -7649,  -7549,  -7448,  -7348,  -7248,  -7147,  -7047,  -6946,  -6846,  -6745,  -6644,  -6543,  -6442,  -6342,  -6241,
 -6139,  -6038,  -5937,  -5836,  -5734,  -5633,  -5532,  -5430,  -5329,  -5227,  -5125,  -5024,  -4922,  -4820,  -4718,  -4616,  -4514,  -4412,  -4310,  -4208,
 -4106,  -4004,  -3902,  -3800,  -3697,  -3595,  -3493,  -3390,  -3288,  -3186,  -3083,  -2981,  -2878,  -2776,  -2673,  -2570,  -2468,  -2365,  -2262,  -2160,
 -2057,  -1954,  -1851,  -1749,  -1646,  -1543,  -1440,  -1337,  -1234,  -1132,  -1029,   -926,   -823,   -720,   -617,   -514,   -411,   -308,   -205,   -102,
};
int16_t lut_square[LUTSIZE] = {
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
 32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,  32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
-32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
};
int16_t lut_triang[LUTSIZE] = {
     0,     65,    131,    196,    262,    327,    393,    458,    524,    589,    655,    720,    786,    851,    917,    983,   1048,   1114,   1179,   1245,
  1310,   1376,   1441,   1507,   1572,   1638,   1703,   1769,   1834,   1900,   1966,   2031,   2097,   2162,   2228,   2293,   2359,   2424,   2490,   2555,
  2621,   2686,   2752,   2817,   2883,   2949,   3014,   3080,   3145,   3211,   3276,   3342,   3407,   3473,   3538,   3604,   3669,   3735,   3800,   3866,
  3932,   3997,   4063,   4128,   4194,   4259,   4325,   4390,   4456,   4521,   4587,   4652,   4718,   4783,   4849,   4915,   4980,   5046,   5111,   5177,
  5242,   5308,   5373,   5439,   5504,   5570,   5635,   5701,   5766,   5832,   5898,   5963,   6029,   6094,   6160,   6225,   6291,   6356,   6422,   6487,
  6553,   6618,   6684,   6750,   6815,   6881,   6946,   7012,   7077,   7143,   7208,   7274,   7339,   7405,   7470,   7536,   7601,   7667,   7733,   7798,
  7864,   7929,   7995,   8060,   8126,   8191,   8257,   8322,   8388,   8453,   8519,   8584,   8650,   8716,   8781,   8847,   8912,   8978,   9043,   9109,
  9174,   9240,   9305,   9371,   9436,   9502,   9567,   9633,   9699,   9764,   9830,   9895,   9961,  10026,  10092,  10157,  10223,  10288,  10354,  10419,
 10485,  10550,  10616,  10682,  10747,  10813,  10878,  10944,  11009,  11075,  11140,  11206,  11271,  11337,  11402,  11468,  11533,  11599,  11665,  11730,
 11796,  11861,  11927,  11992,  12058,  12123,  12189,  12254,  12320,  12385,  12451,  12516,  12582,  12648,  12713,  12779,  12844,  12910,  12975,  13041,
 13106,  13172,  13237,  13303,  13368,  13434,  13500,  13565,  13631,  13696,  13762,  13827,  13893,  13958,  14024,  14089,  14155,  14220,  14286,  14351,
 14417,  14483,  14548,  14614,  14679,  14745,  14810,  14876,  14941,  15007,  15072,  15138,  15203,  15269,  15334,  15400,  15466,  15531,  15597,  15662,
 15728,  15793,  15859,  15924,  15990,  16055,  16121,  16186,  16252,  16317,  16383,  16449,  16514,  16580,  16645,  16711,  16776,  16842,  16907,  16973,
 17038,  17104,  17169,  17235,  17300,  17366,  17432,  17497,  17563,  17628,  17694,  17759,  17825,  17890,  17956,  18021,  18087,  18152,  18218,  18283,
 18349,  18415,  18480,  18546,  18611,  18677,  18742,  18808,  18873,  18939,  19004,  19070,  19135,  19201,  19266,  19332,  19398,  19463,  19529,  19594,
 19660,  19725,  19791,  19856,  19922,  19987,  20053,  20118,  20184,  20250,  20315,  20381,  20446,  20512,  20577,  20643,  20708,  20774,  20839,  20905,
 20970,  21036,  21101,  21167,  21233,  21298,  21364,  21429,  21495,  21560,  21626,  21691,  21757,  21822,  21888,  21953,  22019,  22084,  22150,  22216,
 22281,  22347,  22412,  22478,  22543,  22609,  22674,  22740,  22805,  22871,  22936,  23002,  23067,  23133,  23199,  23264,  23330,  23395,  23461,  23526,
 23592,  23657,  23723,  23788,  23854,  23919,  23985,  24050,  24116,  24182,  24247,  24313,  24378,  24444,  24509,  24575,  24640,  24706,  24771,  24837,
 24902,  24968,  25033,  25099,  25165,  25230,  25296,  25361,  25427,  25492,  25558,  25623,  25689,  25754,  25820,  25885,  25951,  26016,  26082,  26148,
 26213,  26279,  26344,  26410,  26475,  26541,  26606,  26672,  26737,  26803,  26868,  26934,  27000,  27065,  27131,  27196,  27262,  27327,  27393,  27458,
 27524,  27589,  27655,  27720,  27786,  27851,  27917,  27983,  28048,  28114,  28179,  28245,  28310,  28376,  28441,  28507,  28572,  28638,  28703,  28769,
 28834,  28900,  28966,  29031,  29097,  29162,  29228,  29293,  29359,  29424,  29490,  29555,  29621,  29686,  29752,  29817,  29883,  29949,  30014,  30080,
 30145,  30211,  30276,  30342,  30407,  30473,  30538,  30604,  30669,  30735,  30800,  30866,  30932,  30997,  31063,  31128,  31194,  31259,  31325,  31390,
 31456,  31521,  31587,  31652,  31718,  31783,  31849,  31915,  31980,  32046,  32111,  32177,  32242,  32308,  32373,  32439,  32504,  32570,  32635,  32701,
 32767,  32701,  32635,  32570,  32504,  32439,  32373,  32308,  32242,  32177,  32111,  32046,  31980,  31915,  31849,  31783,  31718,  31652,  31587,  31521,
 31456,  31390,  31325,  31259,  31194,  31128,  31063,  30997,  30932,  30866,  30800,  30735,  30669,  30604,  30538,  30473,  30407,  30342,  30276,  30211,
 30145,  30080,  30014,  29949,  29883,  29817,  29752,  29686,  29621,  29555,  29490,  29424,  29359,  29293,  29228,  29162,  29097,  29031,  28966,  28900,
 28834,  28769,  28703,  28638,  28572,  28507,  28441,  28376,  28310,  28245,  28179,  28114,  28048,  27983,  27917,  27851,  27786,  27720,  27655,  27589,
 27524,  27458,  27393,  27327,  27262,  27196,  27131,  27065,  27000,  26934,  26868,  26803,  26737,  26672,  26606,  26541,  26475,  26410,  26344,  26279,
 26213,  26148,  26082,  26016,  25951,  25885,  25820,  25754,  25689,  25623,  25558,  25492,  25427,  25361,  25296,  25230,  25165,  25099,  25033,  24968,
 24902,  24837,  24771,  24706,  24640,  24575,  24509,  24444,  24378,  24313,  24247,  24182,  24116,  24050,  23985,  23919,  23854,  23788,  23723,  23657,
 23592,  23526,  23461,  23395,  23330,  23264,  23199,  23133,  23067,  23002,  22936,  22871,  22805,  22740,  22674,  22609,  22543,  22478,  22412,  22347,
 22281,  22216,  22150,  22084,  22019,  21953,  21888,  21822,  21757,  21691,  21626,  21560,  21495,  21429,  21364,  21298,  21233,  21167,  21101,  21036,
 20970,  20905,  20839,  20774,  20708,  20643,  20577,  20512,  20446,  20381,  20315,  20250,  20184,  20118,  20053,  19987,  19922,  19856,  19791,  19725,
 19660,  19594,  19529,  19463,  19398,  19332,  19266,  19201,  19135,  19070,  19004,  18939,  18873,  18808,  18742,  18677,  18611,  18546,  18480,  18415,
 18349,  18283,  18218,  18152,  18087,  18021,  17956,  17890,  17825,  17759,  17694,  17628,  17563,  17497,  17432,  17366,  17300,  17235,  17169,  17104,
 17038,  16973,  16907,  16842,  16776,  16711,  16645,  16580,  16514,  16449,  16383,  16317,  16252,  16186,  16121,  16055,  15990,  15924,  15859,  15793,
 15728,  15662,  15597,  15531,  15466,  15400,  15334,  15269,  15203,  15138,  15072,  15007,  14941,  14876,  14810,  14745,  14679,  14614,  14548,  14483,
 14417,  14351,  14286,  14220,  14155,  14089,  14024,  13958,  13893,  13827,  13762,  13696,  13631,  13565,  13500,  13434,  13368,  13303,  13237,  13172,
 13106,  13041,  12975,  12910,  12844,  12779,  12713,  12648,  12582,  12516,  12451,  12385,  12320,  12254,  12189,  12123,  12058,  11992,  11927,  11861,
 11796,  11730,  11665,  11599,  11533,  11468,  11402,  11337,  11271,  11206,  11140,  11075,  11009,  10944,  10878,  10813,  10747,  10682,  10616,  10550,
 10485,  10419,  10354,  10288,  10223,  10157,  10092,  10026,   9961,   9895,   9830,   9764,   9699,   9633,   9567,   9502,   9436,   9371,   9305,   9240,
  9174,   9109,   9043,   8978,   8912,   8847,   8781,   8716,   8650,   8584,   8519,   8453,   8388,   8322,   8257,   8191,   8126,   8060,   7995,   7929,
  7864,   7798,   7733,   7667,   7601,   7536,   7470,   7405,   7339,   7274,   7208,   7143,   7077,   7012,   6946,   6881,   6815,   6750,   6684,   6618,
  6553,   6487,   6422,   6356,   6291,   6225,   6160,   6094,   6029,   5963,   5898,   5832,   5766,   5701,   5635,   5570,   5504,   5439,   5373,   5308,
  5242,   5177,   5111,   5046,   4980,   4915,   4849,   4783,   4718,   4652,   4587,   4521,   4456,   4390,   4325,   4259,   4194,   4128,   4063,   3997,
  3932,   3866,   3800,   3735,   3669,   3604,   3538,   3473,   3407,   3342,   3276,   3211,   3145,   3080,   3014,   2949,   2883,   2817,   2752,   2686,
  2621,   2555,   2490,   2424,   2359,   2293,   2228,   2162,   2097,   2031,   1966,   1900,   1834,   1769,   1703,   1638,   1572,   1507,   1441,   1376,
  1310,   1245,   1179,   1114,   1048,    983,    917,    851,    786,    720,    655,    589,    524,    458,    393,    327,    262,    196,    131,     65,
     0,    -65,   -131,   -196,   -262,   -327,   -393,   -458,   -524,   -589,   -655,   -720,   -786,   -851,   -917,   -983,  -1048,  -1114,  -1179,  -1245,
 -1310,  -1376,  -1441,  -1507,  -1572,  -1638,  -1703,  -1769,  -1834,  -1900,  -1966,  -2031,  -2097,  -2162,  -2228,  -2293,  -2359,  -2424,  -2490,  -2555,
 -2621,  -2686,  -2752,  -2817,  -2883,  -2949,  -3014,  -3080,  -3145,  -3211,  -3276,  -3342,  -3407,  -3473,  -3538,  -3604,  -3669,  -3735,  -3800,  -3866,
 -3932,  -3997,  -4063,  -4128,  -4194,  -4259,  -4325,  -4390,  -4456,  -4521,  -4587,  -4652,  -4718,  -4783,  -4849,  -4915,  -4980,  -5046,  -5111,  -5177,
 -5242,  -5308,  -5373,  -5439,  -5504,  -5570,  -5635,  -5701,  -5766,  -5832,  -5898,  -5963,  -6029,  -6094,  -6160,  -6225,  -6291,  -6356,  -6422,  -6487,
 -6553,  -6618,  -6684,  -6750,  -6815,  -6881,  -6946,  -7012,  -7077,  -7143,  -7208,  -7274,  -7339,  -7405,  -7470,  -7536,  -7601,  -7667,  -7733,  -7798,
 -7864,  -7929,  -7995,  -8060,  -8126,  -8191,  -8257,  -8322,  -8388,  -8453,  -8519,  -8584,  -8650,  -8716,  -8781,  -8847,  -8912,  -8978,  -9043,  -9109,
 -9174,  -9240,  -9305,  -9371,  -9436,  -9502,  -9567,  -9633,  -9699,  -9764,  -9830,  -9895,  -9961, -10026, -10092, -10157, -10223, -10288, -10354, -10419,
-10485, -10550, -10616, -10682, -10747, -10813, -10878, -10944, -11009, -11075, -11140, -11206, -11271, -11337, -11402, -11468, -11533, -11599, -11665, -11730,
-11796, -11861, -11927, -11992, -12058, -12123, -12189, -12254, -12320, -12385, -12451, -12516, -12582, -12648, -12713, -12779, -12844, -12910, -12975, -13041,
-13106, -13172, -13237, -13303, -13368, -13434, -13500, -13565, -13631, -13696, -13762, -13827, -13893, -13958, -14024, -14089, -14155, -14220, -14286, -14351,
-14417, -14483, -14548, -14614, -14679, -14745, -14810, -14876, -14941, -15007, -15072, -15138, -15203, -15269, -15334, -15400, -15466, -15531, -15597, -15662,
-15728, -15793, -15859, -15924, -15990, -16055, -16121, -16186, -16252, -16317, -16383, -16449, -16514, -16580, -16645, -16711, -16776, -16842, -16907, -16973,
-17038, -17104, -17169, -17235, -17300, -17366, -17432, -17497, -17563, -17628, -17694, -17759, -17825, -17890, -17956, -18021, -18087, -18152, -18218, -18283,
-18349, -18415, -18480, -18546, -18611, -18677, -18742, -18808, -18873, -18939, -19004, -19070, -19135, -19201, -19266, -19332, -19398, -19463, -19529, -19594,
-19660, -19725, -19791, -19856, -19922, -19987, -20053, -20118, -20184, -20250, -20315, -20381, -20446, -20512, -20577, -20643, -20708, -20774, -20839, -20905,
-20970, -21036, -21101, -21167, -21233, -21298, -21364, -21429, -21495, -21560, -21626, -21691, -21757, -21822, -21888, -21953, -22019, -22084, -22150, -22216,
-22281, -22347, -22412, -22478, -22543, -22609, -22674, -22740, -22805, -22871, -22936, -23002, -23067, -23133, -23199, -23264, -23330, -23395, -23461, -23526,
-23592, -23657, -23723, -23788, -23854, -23919, -23985, -24050, -24116, -24182, -24247, -24313, -24378, -24444, -24509, -24575, -24640, -24706, -24771, -24837,
-24902, -24968, -25033, -25099, -25165, -25230, -25296, -25361, -25427, -25492, -25558, -25623, -25689, -25754, -25820, -25885, -25951, -26016, -26082, -26148,
-26213, -26279, -26344, -26410, -26475, -26541, -26606, -26672, -26737, -26803, -26868, -26934, -27000, -27065, -27131, -27196, -27262, -27327, -27393, -27458,
-27524, -27589, -27655, -27720, -27786, -27851, -27917, -27983, -28048, -28114, -28179, -28245, -28310, -28376, -28441, -28507, -28572, -28638, -28703, -28769,
-28834, -28900, -28966, -29031, -29097, -29162, -29228, -29293, -29359, -29424, -29490, -29555, -29621, -29686, -29752, -29817, -29883, -29949, -30014, -30080,
-30145, -30211, -30276, -30342, -30407, -30473, -30538, -30604, -30669, -30735, -30800, -30866, -30932, -30997, -31063, -31128, -31194, -31259, -31325, -31390,
-31456, -31521, -31587, -31652, -31718, -31783, -31849, -31915, -31980, -32046, -32111, -32177, -32242, -32308, -32373, -32439, -32504, -32570, -32635, -32701,
-32767, -32701, -32635, -32570, -32504, -32439, -32373, -32308, -32242, -32177, -32111, -32046, -31980, -31915, -31849, -31783, -31718, -31652, -31587, -31521,
-31456, -31390, -31325, -31259, -31194, -31128, -31063, -30997, -30932, -30866, -30800, -30735, -30669, -30604, -30538, -30473, -30407, -30342, -30276, -30211,
-30145, -30080, -30014, -29949, -29883, -29817, -29752, -29686, -29621, -29555, -29490, -29424, -29359, -29293, -29228, -29162, -29097, -29031, -28966, -28900,
-28834, -28769, -28703, -28638, -28572, -28507, -28441, -28376, -28310, -28245, -28179, -28114, -28048, -27983, -27917, -27851, -27786, -27720, -27655, -27589,
-27524, -27458, -27393, -27327, -27262, -27196, -27131, -27065, -27000, -26934, -26868, -26803, -26737, -26672, -26606, -26541, -26475, -26410, -26344, -26279,
-26213, -26148, -26082, -26016, -25951, -25885, -25820, -25754, -25689, -25623, -25558, -25492, -25427, -25361, -25296, -25230, -25165, -25099, -25033, -24968,
-24902, -24837, -24771, -24706, -24640, -24575, -24509, -24444, -24378, -24313, -24247, -24182, -24116, -24050, -23985, -23919, -23854, -23788, -23723, -23657,
-23592, -23526, -23461, -23395, -23330, -23264, -23199, -23133, -23067, -23002, -22936, -22871, -22805, -22740, -22674, -22609, -22543, -22478, -22412, -22347,
-22281, -22216, -22150, -22084, -22019, -21953, -21888, -21822, -21757, -21691, -21626, -21560, -21495, -21429, -21364, -21298, -21233, -21167, -21101, -21036,
-20970, -20905, -20839, -20774, -20708, -20643, -20577, -20512, -20446, -20381, -20315, -20250, -20184, -20118, -20053, -19987, -19922, -19856, -19791, -19725,
-19660, -19594, -19529, -19463, -19398, -19332, -19266, -19201, -19135, -19070, -19004, -18939, -18873, -18808, -18742, -18677, -18611, -18546, -18480, -18415,
-18349, -18283, -18218, -18152, -18087, -18021, -17956, -17890, -17825, -17759, -17694, -17628, -17563, -17497, -17432, -17366, -17300, -17235, -17169, -17104,
-17038, -16973, -16907, -16842, -16776, -16711, -16645, -16580, -16514, -16449, -16383, -16317, -16252, -16186, -16121, -16055, -15990, -15924, -15859, -15793,
-15728, -15662, -15597, -15531, -15466, -15400, -15334, -15269, -15203, -15138, -15072, -15007, -14941, -14876, -14810, -14745, -14679, -14614, -14548, -14483,
-14417, -14351, -14286, -14220, -14155, -14089, -14024, -13958, -13893, -13827, -13762, -13696, -13631, -13565, -13500, -13434, -13368, -13303, -13237, -13172,
-13106, -13041, -12975, -12910, -12844, -12779, -12713, -12648, -12582, -12516, -12451, -12385, -12320, -12254, -12189, -12123, -12058, -11992, -11927, -11861,
-11796, -11730, -11665, -11599, -11533, -11468, -11402, -11337, -11271, -11206, -11140, -11075, -11009, -10944, -10878, -10813, -10747, -10682, -10616, -10550,
-10485, -10419, -10354, -10288, -10223, -10157, -10092, -10026,  -9961,  -9895,  -9830,  -9764,  -9699,  -9633,  -9567,  -9502,  -9436,  -9371,  -9305,  -9240,
 -9174,  -9109,  -9043,  -8978,  -8912,  -8847,  -8781,  -8716,  -8650,  -8584,  -8519,  -8453,  -8388,  -8322,  -8257,  -8191,  -8126,  -8060,  -7995,  -7929,
 -7864,  -7798,  -7733,  -7667,  -7601,  -7536,  -7470,  -7405,  -7339,  -7274,  -7208,  -7143,  -7077,  -7012,  -6946,  -6881,  -6815,  -6750,  -6684,  -6618,
 -6553,  -6487,  -6422,  -6356,  -6291,  -6225,  -6160,  -6094,  -6029,  -5963,  -5898,  -5832,  -5766,  -5701,  -5635,  -5570,  -5504,  -5439,  -5373,  -5308,
 -5242,  -5177,  -5111,  -5046,  -4980,  -4915,  -4849,  -4783,  -4718,  -4652,  -4587,  -4521,  -4456,  -4390,  -4325,  -4259,  -4194,  -4128,  -4063,  -3997,
 -3932,  -3866,  -3800,  -3735,  -3669,  -3604,  -3538,  -3473,  -3407,  -3342,  -3276,  -3211,  -3145,  -3080,  -3014,  -2949,  -2883,  -2817,  -2752,  -2686,
 -2621,  -2555,  -2490,  -2424,  -2359,  -2293,  -2228,  -2162,  -2097,  -2031,  -1966,  -1900,  -1834,  -1769,  -1703,  -1638,  -1572,  -1507,  -1441,  -1376,
 -1310,  -1245,  -1179,  -1114,  -1048,   -983,   -917,   -851,   -786,   -720,   -655,   -589,   -524,   -458,   -393,   -327,   -262,   -196,   -131,    -65,
};
int16_t lut_sawtoo[LUTSIZE] = {
-32767, -32734, -32701, -32668, -32635, -32603, -32570, -32537, -32504, -32471, -32439, -32406, -32373, -32340, -32308, -32275, -32242, -32209, -32176, -32144,
-32111, -32078, -32045, -32012, -31980, -31947, -31914, -31881, -31849, -31816, -31783, -31750, -31717, -31685, -31652, -31619, -31586, -31554, -31521, -31488,
-31455, -31422, -31390, -31357, -31324, -31291, -31258, -31226, -31193, -31160, -31127, -31095, -31062, -31029, -30996, -30963, -30931, -30898, -30865, -30832,
-30799, -30767, -30734, -30701, -30668, -30636, -30603, -30570, -30537, -30504, -30472, -30439, -30406, -30373, -30341, -30308, -30275, -30242, -30209, -30177,
-30144, -30111, -30078, -30045, -30013, -29980, -29947, -29914, -29882, -29849, -29816, -29783, -29750, -29718, -29685, -29652, -29619, -29587, -29554, -29521,
-29488, -29455, -29423, -29390, -29357, -29324, -29291, -29259, -29226, -29193, -29160, -29128, -29095, -29062, -29029, -28996, -28964, -28931, -28898, -28865,
-28832, -28800, -28767, -28734, -28701, -28669, -28636, -28603, -28570, -28537, -28505, -28472, -28439, -28406, -28374, -28341, -28308, -28275, -28242, -28210,
-28177, -28144, -28111, -28078, -28046, -28013, -27980, -27947, -27915, -27882, -27849, -27816, -27783, -27751, -27718, -27685, -27652, -27620, -27587, -27554,
-27521, -27488, -27456, -27423, -27390, -27357, -27324, -27292, -27259, -27226, -27193, -27161, -27128, -27095, -27062, -27029, -26997, -26964, -26931, -26898,
-26865, -26833, -26800, -26767, -26734, -26702, -26669, -26636, -26603, -26570, -26538, -26505, -26472, -26439, -26407, -26374, -26341, -26308, -26275, -26243,
-26210, -26177, -26144, -26111, -26079, -26046, -26013, -25980, -25948, -25915, -25882, -25849, -25816, -25784, -25751, -25718, -25685, -25653, -25620, -25587,
-25554, -25521, -25489, -25456, -25423, -25390, -25357, -25325, -25292, -25259, -25226, -25194, -25161, -25128, -25095, -25062, -25030, -24997, -24964, -24931,
-24898, -24866, -24833, -24800, -24767, -24735, -24702, -24669, -24636, -24603, -24571, -24538, -24505, -24472, -24440, -24407, -24374, -24341, -24308, -24276,
-24243, -24210, -24177, -24144, -24112, -24079, -24046, -24013, -23981, -23948, -23915, -23882, -23849, -23817, -23784, -23751, -23718, -23686, -23653, -23620,
-23587, -23554, -23522, -23489, -23456, -23423, -23390, -23358, -23325, -23292, -23259, -23227, -23194, -23161, -23128, -23095, -23063, -23030, -22997, -22964,
-22931, -22899, -22866, -22833, -22800, -22768, -22735, -22702, -22669, -22636, -22604, -22571, -22538, -22505, -22473, -22440, -22407, -22374, -22341, -22309,
-22276, -22243, -22210, -22177, -22145, -22112, -22079, -22046, -22014, -21981, -21948, -21915, -21882, -21850, -21817, -21784, -21751, -21718, -21686, -21653,
-21620, -21587, -21555, -21522, -21489, -21456, -21423, -21391, -21358, -21325, -21292, -21260, -21227, -21194, -21161, -21128, -21096, -21063, -21030, -20997,
-20964, -20932, -20899, -20866, -20833, -20801, -20768, -20735, -20702, -20669, -20637, -20604, -20571, -20538, -20506, -20473, -20440, -20407, -20374, -20342,
-20309, -20276, -20243, -20210, -20178, -20145, -20112, -20079, -20047, -20014, -19981, -19948, -19915, -19883, -19850, -19817, -19784, -19751, -19719, -19686,
-19653, -19620, -19588, -19555, -19522, -19489, -19456, -19424, -19391, -19358, -19325, -19293, -19260, -19227, -19194, -19161, -19129, -19096, -19063, -19030,
-18997, -18965, -18932, -18899, -18866, -18834, -18801, -18768, -18735, -18702, -18670, -18637, -18604, -18571, -18539, -18506, -18473, -18440, -18407, -18375,
-18342, -18309, -18276, -18243, -18211, -18178, -18145, -18112, -18080, -18047, -18014, -17981, -17948, -17916, -17883, -17850, -17817, -17784, -17752, -17719,
-17686, -17653, -17621, -17588, -17555, -17522, -17489, -17457, -17424, -17391, -17358, -17326, -17293, -17260, -17227, -17194, -17162, -17129, -17096, -17063,
-17030, -16998, -16965, -16932, -16899, -16867, -16834, -16801, -16768, -16735, -16703, -16670, -16637, -16604, -16572, -16539, -16506, -16473, -16440, -16408,
-16375, -16342, -16309, -16276, -16244, -16211, -16178, -16145, -16113, -16080, -16047, -16014, -15981, -15949, -15916, -15883, -15850, -15817, -15785, -15752,
-15719, -15686, -15654, -15621, -15588, -15555, -15522, -15490, -15457, -15424, -15391, -15359, -15326, -15293, -15260, -15227, -15195, -15162, -15129, -15096,
-15063, -15031, -14998, -14965, -14932, -14900, -14867, -14834, -14801, -14768, -14736, -14703, -14670, -14637, -14605, -14572, -14539, -14506, -14473, -14441,
-14408, -14375, -14342, -14309, -14277, -14244, -14211, -14178, -14146, -14113, -14080, -14047, -14014, -13982, -13949, -13916, -13883, -13850, -13818, -13785,
-13752, -13719, -13687, -13654, -13621, -13588, -13555, -13523, -13490, -13457, -13424, -13392, -13359, -13326, -13293, -13260, -13228, -13195, -13162, -13129,
-13096, -13064, -13031, -12998, -12965, -12933, -12900, -12867, -12834, -12801, -12769, -12736, -12703, -12670, -12637, -12605, -12572, -12539, -12506, -12474,
-12441, -12408, -12375, -12342, -12310, -12277, -12244, -12211, -12179, -12146, -12113, -12080, -12047, -12015, -11982, -11949, -11916, -11883, -11851, -11818,
-11785, -11752, -11720, -11687, -11654, -11621, -11588, -11556, -11523, -11490, -11457, -11425, -11392, -11359, -11326, -11293, -11261, -11228, -11195, -11162,
-11129, -11097, -11064, -11031, -10998, -10966, -10933, -10900, -10867, -10834, -10802, -10769, -10736, -10703, -10670, -10638, -10605, -10572, -10539, -10507,
-10474, -10441, -10408, -10375, -10343, -10310, -10277, -10244, -10212, -10179, -10146, -10113, -10080, -10048, -10015,  -9982,  -9949,  -9916,  -9884,  -9851,
 -9818,  -9785,  -9753,  -9720,  -9687,  -9654,  -9621,  -9589,  -9556,  -9523,  -9490,  -9458,  -9425,  -9392,  -9359,  -9326,  -9294,  -9261,  -9228,  -9195,
 -9162,  -9130,  -9097,  -9064,  -9031,  -8999,  -8966,  -8933,  -8900,  -8867,  -8835,  -8802,  -8769,  -8736,  -8703,  -8671,  -8638,  -8605,  -8572,  -8540,
 -8507,  -8474,  -8441,  -8408,  -8376,  -8343,  -8310,  -8277,  -8245,  -8212,  -8179,  -8146,  -8113,  -8081,  -8048,  -8015,  -7982,  -7949,  -7917,  -7884,
 -7851,  -7818,  -7786,  -7753,  -7720,  -7687,  -7654,  -7622,  -7589,  -7556,  -7523,  -7491,  -7458,  -7425,  -7392,  -7359,  -7327,  -7294,  -7261,  -7228,
 -7195,  -7163,  -7130,  -7097,  -7064,  -7032,  -6999,  -6966,  -6933,  -6900,  -6868,  -6835,  -6802,  -6769,  -6736,  -6704,  -6671,  -6638,  -6605,  -6573,
 -6540,  -6507,  -6474,  -6441,  -6409,  -6376,  -6343,  -6310,  -6278,  -6245,  -6212,  -6179,  -6146,  -6114,  -6081,  -6048,  -6015,  -5982,  -5950,  -5917,
 -5884,  -5851,  -5819,  -5786,  -5753,  -5720,  -5687,  -5655,  -5622,  -5589,  -5556,  -5524,  -5491,  -5458,  -5425,  -5392,  -5360,  -5327,  -5294,  -5261,
 -5228,  -5196,  -5163,  -5130,  -5097,  -5065,  -5032,  -4999,  -4966,  -4933,  -4901,  -4868,  -4835,  -4802,  -4769,  -4737,  -4704,  -4671,  -4638,  -4606,
 -4573,  -4540,  -4507,  -4474,  -4442,  -4409,  -4376,  -4343,  -4311,  -4278,  -4245,  -4212,  -4179,  -4147,  -4114,  -4081,  -4048,  -4015,  -3983,  -3950,
 -3917,  -3884,  -3852,  -3819,  -3786,  -3753,  -3720,  -3688,  -3655,  -3622,  -3589,  -3557,  -3524,  -3491,  -3458,  -3425,  -3393,  -3360,  -3327,  -3294,
 -3261,  -3229,  -3196,  -3163,  -3130,  -3098,  -3065,  -3032,  -2999,  -2966,  -2934,  -2901,  -2868,  -2835,  -2802,  -2770,  -2737,  -2704,  -2671,  -2639,
 -2606,  -2573,  -2540,  -2507,  -2475,  -2442,  -2409,  -2376,  -2344,  -2311,  -2278,  -2245,  -2212,  -2180,  -2147,  -2114,  -2081,  -2048,  -2016,  -1983,
 -1950,  -1917,  -1885,  -1852,  -1819,  -1786,  -1753,  -1721,  -1688,  -1655,  -1622,  -1589,  -1557,  -1524,  -1491,  -1458,  -1426,  -1393,  -1360,  -1327,
 -1294,  -1262,  -1229,  -1196,  -1163,  -1131,  -1098,  -1065,  -1032,   -999,   -967,   -934,   -901,   -868,   -835,   -803,   -770,   -737,   -704,   -672,
  -639,   -606,   -573,   -540,   -508,   -475,   -442,   -409,   -377,   -344,   -311,   -278,   -245,   -213,   -180,   -147,   -114,    -81,    -49,    -16,
    16,     49,     81,    114,    147,    180,    213,    245,    278,    311,    344,    377,    409,    442,    475,    508,    540,    573,    606,    639,
   672,    704,    737,    770,    803,    835,    868,    901,    934,    967,    999,   1032,   1065,   1098,   1131,   1163,   1196,   1229,   1262,   1294,
  1327,   1360,   1393,   1426,   1458,   1491,   1524,   1557,   1589,   1622,   1655,   1688,   1721,   1753,   1786,   1819,   1852,   1885,   1917,   1950,
  1983,   2016,   2048,   2081,   2114,   2147,   2180,   2212,   2245,   2278,   2311,   2344,   2376,   2409,   2442,   2475,   2507,   2540,   2573,   2606,
  2639,   2671,   2704,   2737,   2770,   2802,   2835,   2868,   2901,   2934,   2966,   2999,   3032,   3065,   3098,   3130,   3163,   3196,   3229,   3261,
  3294,   3327,   3360,   3393,   3425,   3458,   3491,   3524,   3556,   3589,   3622,   3655,   3688,   3720,   3753,   3786,   3819,   3852,   3884,   3917,
  3950,   3983,   4015,   4048,   4081,   4114,   4147,   4179,   4212,   4245,   4278,   4311,   4343,   4376,   4409,   4442,   4474,   4507,   4540,   4573,
  4606,   4638,   4671,   4704,   4737,   4769,   4802,   4835,   4868,   4901,   4933,   4966,   4999,   5032,   5065,   5097,   5130,   5163,   5196,   5228,
  5261,   5294,   5327,   5360,   5392,   5425,   5458,   5491,   5524,   5556,   5589,   5622,   5655,   5687,   5720,   5753,   5786,   5819,   5851,   5884,
  5917,   5950,   5982,   6015,   6048,   6081,   6114,   6146,   6179,   6212,   6245,   6278,   6310,   6343,   6376,   6409,   6441,   6474,   6507,   6540,
  6573,   6605,   6638,   6671,   6704,   6736,   6769,   6802,   6835,   6868,   6900,   6933,   6966,   6999,   7032,   7064,   7097,   7130,   7163,   7195,
  7228,   7261,   7294,   7327,   7359,   7392,   7425,   7458,   7491,   7523,   7556,   7589,   7622,   7654,   7687,   7720,   7753,   7786,   7818,   7851,
  7884,   7917,   7949,   7982,   8015,   8048,   8081,   8113,   8146,   8179,   8212,   8245,   8277,   8310,   8343,   8376,   8408,   8441,   8474,   8507,
  8540,   8572,   8605,   8638,   8671,   8703,   8736,   8769,   8802,   8835,   8867,   8900,   8933,   8966,   8999,   9031,   9064,   9097,   9130,   9162,
  9195,   9228,   9261,   9294,   9326,   9359,   9392,   9425,   9458,   9490,   9523,   9556,   9589,   9621,   9654,   9687,   9720,   9753,   9785,   9818,
  9851,   9884,   9916,   9949,   9982,  10015,  10048,  10080,  10113,  10146,  10179,  10212,  10244,  10277,  10310,  10343,  10375,  10408,  10441,  10474,
 10507,  10539,  10572,  10605,  10638,  10670,  10703,  10736,  10769,  10802,  10834,  10867,  10900,  10933,  10966,  10998,  11031,  11064,  11097,  11129,
 11162,  11195,  11228,  11261,  11293,  11326,  11359,  11392,  11425,  11457,  11490,  11523,  11556,  11588,  11621,  11654,  11687,  11720,  11752,  11785,
 11818,  11851,  11883,  11916,  11949,  11982,  12015,  12047,  12080,  12113,  12146,  12179,  12211,  12244,  12277,  12310,  12342,  12375,  12408,  12441,
 12474,  12506,  12539,  12572,  12605,  12637,  12670,  12703,  12736,  12769,  12801,  12834,  12867,  12900,  12933,  12965,  12998,  13031,  13064,  13096,
 13129,  13162,  13195,  13228,  13260,  13293,  13326,  13359,  13392,  13424,  13457,  13490,  13523,  13555,  13588,  13621,  13654,  13687,  13719,  13752,
 13785,  13818,  13850,  13883,  13916,  13949,  13982,  14014,  14047,  14080,  14113,  14146,  14178,  14211,  14244,  14277,  14309,  14342,  14375,  14408,
 14441,  14473,  14506,  14539,  14572,  14605,  14637,  14670,  14703,  14736,  14768,  14801,  14834,  14867,  14900,  14932,  14965,  14998,  15031,  15063,
 15096,  15129,  15162,  15195,  15227,  15260,  15293,  15326,  15359,  15391,  15424,  15457,  15490,  15522,  15555,  15588,  15621,  15654,  15686,  15719,
 15752,  15785,  15817,  15850,  15883,  15916,  15949,  15981,  16014,  16047,  16080,  16113,  16145,  16178,  16211,  16244,  16276,  16309,  16342,  16375,
 16408,  16440,  16473,  16506,  16539,  16572,  16604,  16637,  16670,  16703,  16735,  16768,  16801,  16834,  16867,  16899,  16932,  16965,  16998,  17030,
 17063,  17096,  17129,  17162,  17194,  17227,  17260,  17293,  17326,  17358,  17391,  17424,  17457,  17489,  17522,  17555,  17588,  17621,  17653,  17686,
 17719,  17752,  17784,  17817,  17850,  17883,  17916,  17948,  17981,  18014,  18047,  18080,  18112,  18145,  18178,  18211,  18243,  18276,  18309,  18342,
 18375,  18407,  18440,  18473,  18506,  18539,  18571,  18604,  18637,  18670,  18702,  18735,  18768,  18801,  18834,  18866,  18899,  18932,  18965,  18997,
 19030,  19063,  19096,  19129,  19161,  19194,  19227,  19260,  19293,  19325,  19358,  19391,  19424,  19456,  19489,  19522,  19555,  19588,  19620,  19653,
 19686,  19719,  19751,  19784,  19817,  19850,  19883,  19915,  19948,  19981,  20014,  20047,  20079,  20112,  20145,  20178,  20210,  20243,  20276,  20309,
 20342,  20374,  20407,  20440,  20473,  20506,  20538,  20571,  20604,  20637,  20669,  20702,  20735,  20768,  20801,  20833,  20866,  20899,  20932,  20964,
 20997,  21030,  21063,  21096,  21128,  21161,  21194,  21227,  21260,  21292,  21325,  21358,  21391,  21423,  21456,  21489,  21522,  21555,  21587,  21620,
 21653,  21686,  21718,  21751,  21784,  21817,  21850,  21882,  21915,  21948,  21981,  22014,  22046,  22079,  22112,  22145,  22177,  22210,  22243,  22276,
 22309,  22341,  22374,  22407,  22440,  22473,  22505,  22538,  22571,  22604,  22636,  22669,  22702,  22735,  22768,  22800,  22833,  22866,  22899,  22931,
 22964,  22997,  23030,  23063,  23095,  23128,  23161,  23194,  23227,  23259,  23292,  23325,  23358,  23390,  23423,  23456,  23489,  23522,  23554,  23587,
 23620,  23653,  23685,  23718,  23751,  23784,  23817,  23849,  23882,  23915,  23948,  23981,  24013,  24046,  24079,  24112,  24144,  24177,  24210,  24243,
 24276,  24308,  24341,  24374,  24407,  24440,  24472,  24505,  24538,  24571,  24603,  24636,  24669,  24702,  24735,  24767,  24800,  24833,  24866,  24898,
 24931,  24964,  24997,  25030,  25062,  25095,  25128,  25161,  25194,  25226,  25259,  25292,  25325,  25357,  25390,  25423,  25456,  25489,  25521,  25554,
 25587,  25620,  25653,  25685,  25718,  25751,  25784,  25816,  25849,  25882,  25915,  25948,  25980,  26013,  26046,  26079,  26111,  26144,  26177,  26210,
 26243,  26275,  26308,  26341,  26374,  26407,  26439,  26472,  26505,  26538,  26570,  26603,  26636,  26669,  26702,  26734,  26767,  26800,  26833,  26865,
 26898,  26931,  26964,  26997,  27029,  27062,  27095,  27128,  27161,  27193,  27226,  27259,  27292,  27324,  27357,  27390,  27423,  27456,  27488,  27521,
 27554,  27587,  27620,  27652,  27685,  27718,  27751,  27783,  27816,  27849,  27882,  27915,  27947,  27980,  28013,  28046,  28078,  28111,  28144,  28177,
 28210,  28242,  28275,  28308,  28341,  28374,  28406,  28439,  28472,  28505,  28537,  28570,  28603,  28636,  28669,  28701,  28734,  28767,  28800,  28832,
 28865,  28898,  28931,  28964,  28996,  29029,  29062,  29095,  29128,  29160,  29193,  29226,  29259,  29291,  29324,  29357,  29390,  29423,  29455,  29488,
 29521,  29554,  29587,  29619,  29652,  29685,  29718,  29750,  29783,  29816,  29849,  29882,  29914,  29947,  29980,  30013,  30045,  30078,  30111,  30144,
 30177,  30209,  30242,  30275,  30308,  30341,  30373,  30406,  30439,  30472,  30504,  30537,  30570,  30603,  30636,  30668,  30701,  30734,  30767,  30799,
 30832,  30865,  30898,  30931,  30963,  30996,  31029,  31062,  31095,  31127,  31160,  31193,  31226,  31258,  31291,  31324,  31357,  31390,  31422,  31455,
 31488,  31521,  31554,  31586,  31619,  31652,  31685,  31717,  31750,  31783,  31816,  31849,  31881,  31914,  31947,  31980,  32012,  32045,  32078,  32111,
 32144,  32176,  32209,  32242,  32275,  32308,  32340,  32373,  32406,  32439,  32471,  32504,  32537,  32570,  32603,  32635,  32668,  32701,  32734,  32766,
};
int16_t lut_invsaw[LUTSIZE] = {
 32768,  32735,  32702,  32669,  32636,  32604,  32571,  32538,  32505,  32472,  32440,  32407,  32374,  32341,  32309,  32276,  32243,  32210,  32177,  32145,
 32112,  32079,  32046,  32013,  31981,  31948,  31915,  31882,  31850,  31817,  31784,  31751,  31718,  31686,  31653,  31620,  31587,  31555,  31522,  31489,
 31456,  31423,  31391,  31358,  31325,  31292,  31259,  31227,  31194,  31161,  31128,  31096,  31063,  31030,  30997,  30964,  30932,  30899,  30866,  30833,
 30800,  30768,  30735,  30702,  30669,  30637,  30604,  30571,  30538,  30505,  30473,  30440,  30407,  30374,  30342,  30309,  30276,  30243,  30210,  30178,
 30145,  30112,  30079,  30046,  30014,  29981,  29948,  29915,  29883,  29850,  29817,  29784,  29751,  29719,  29686,  29653,  29620,  29588,  29555,  29522,
 29489,  29456,  29424,  29391,  29358,  29325,  29292,  29260,  29227,  29194,  29161,  29129,  29096,  29063,  29030,  28997,  28965,  28932,  28899,  28866,
 28833,  28801,  28768,  28735,  28702,  28670,  28637,  28604,  28571,  28538,  28506,  28473,  28440,  28407,  28375,  28342,  28309,  28276,  28243,  28211,
 28178,  28145,  28112,  28079,  28047,  28014,  27981,  27948,  27916,  27883,  27850,  27817,  27784,  27752,  27719,  27686,  27653,  27621,  27588,  27555,
 27522,  27489,  27457,  27424,  27391,  27358,  27325,  27293,  27260,  27227,  27194,  27162,  27129,  27096,  27063,  27030,  26998,  26965,  26932,  26899,
 26866,  26834,  26801,  26768,  26735,  26703,  26670,  26637,  26604,  26571,  26539,  26506,  26473,  26440,  26408,  26375,  26342,  26309,  26276,  26244,
 26211,  26178,  26145,  26112,  26080,  26047,  26014,  25981,  25949,  25916,  25883,  25850,  25817,  25785,  25752,  25719,  25686,  25654,  25621,  25588,
 25555,  25522,  25490,  25457,  25424,  25391,  25358,  25326,  25293,  25260,  25227,  25195,  25162,  25129,  25096,  25063,  25031,  24998,  24965,  24932,
 24899,  24867,  24834,  24801,  24768,  24736,  24703,  24670,  24637,  24604,  24572,  24539,  24506,  24473,  24441,  24408,  24375,  24342,  24309,  24277,
 24244,  24211,  24178,  24145,  24113,  24080,  24047,  24014,  23982,  23949,  23916,  23883,  23850,  23818,  23785,  23752,  23719,  23687,  23654,  23621,
 23588,  23555,  23523,  23490,  23457,  23424,  23391,  23359,  23326,  23293,  23260,  23228,  23195,  23162,  23129,  23096,  23064,  23031,  22998,  22965,
 22932,  22900,  22867,  22834,  22801,  22769,  22736,  22703,  22670,  22637,  22605,  22572,  22539,  22506,  22474,  22441,  22408,  22375,  22342,  22310,
 22277,  22244,  22211,  22178,  22146,  22113,  22080,  22047,  22015,  21982,  21949,  21916,  21883,  21851,  21818,  21785,  21752,  21719,  21687,  21654,
 21621,  21588,  21556,  21523,  21490,  21457,  21424,  21392,  21359,  21326,  21293,  21261,  21228,  21195,  21162,  21129,  21097,  21064,  21031,  20998,
 20965,  20933,  20900,  20867,  20834,  20802,  20769,  20736,  20703,  20670,  20638,  20605,  20572,  20539,  20507,  20474,  20441,  20408,  20375,  20343,
 20310,  20277,  20244,  20211,  20179,  20146,  20113,  20080,  20048,  20015,  19982,  19949,  19916,  19884,  19851,  19818,  19785,  19752,  19720,  19687,
 19654,  19621,  19589,  19556,  19523,  19490,  19457,  19425,  19392,  19359,  19326,  19294,  19261,  19228,  19195,  19162,  19130,  19097,  19064,  19031,
 18998,  18966,  18933,  18900,  18867,  18835,  18802,  18769,  18736,  18703,  18671,  18638,  18605,  18572,  18540,  18507,  18474,  18441,  18408,  18376,
 18343,  18310,  18277,  18244,  18212,  18179,  18146,  18113,  18081,  18048,  18015,  17982,  17949,  17917,  17884,  17851,  17818,  17785,  17753,  17720,
 17687,  17654,  17622,  17589,  17556,  17523,  17490,  17458,  17425,  17392,  17359,  17327,  17294,  17261,  17228,  17195,  17163,  17130,  17097,  17064,
 17031,  16999,  16966,  16933,  16900,  16868,  16835,  16802,  16769,  16736,  16704,  16671,  16638,  16605,  16573,  16540,  16507,  16474,  16441,  16409,
 16376,  16343,  16310,  16277,  16245,  16212,  16179,  16146,  16114,  16081,  16048,  16015,  15982,  15950,  15917,  15884,  15851,  15818,  15786,  15753,
 15720,  15687,  15655,  15622,  15589,  15556,  15523,  15491,  15458,  15425,  15392,  15360,  15327,  15294,  15261,  15228,  15196,  15163,  15130,  15097,
 15064,  15032,  14999,  14966,  14933,  14901,  14868,  14835,  14802,  14769,  14737,  14704,  14671,  14638,  14606,  14573,  14540,  14507,  14474,  14442,
 14409,  14376,  14343,  14310,  14278,  14245,  14212,  14179,  14147,  14114,  14081,  14048,  14015,  13983,  13950,  13917,  13884,  13851,  13819,  13786,
 13753,  13720,  13688,  13655,  13622,  13589,  13556,  13524,  13491,  13458,  13425,  13393,  13360,  13327,  13294,  13261,  13229,  13196,  13163,  13130,
 13097,  13065,  13032,  12999,  12966,  12934,  12901,  12868,  12835,  12802,  12770,  12737,  12704,  12671,  12638,  12606,  12573,  12540,  12507,  12475,
 12442,  12409,  12376,  12343,  12311,  12278,  12245,  12212,  12180,  12147,  12114,  12081,  12048,  12016,  11983,  11950,  11917,  11884,  11852,  11819,
 11786,  11753,  11721,  11688,  11655,  11622,  11589,  11557,  11524,  11491,  11458,  11426,  11393,  11360,  11327,  11294,  11262,  11229,  11196,  11163,
 11130,  11098,  11065,  11032,  10999,  10967,  10934,  10901,  10868,  10835,  10803,  10770,  10737,  10704,  10671,  10639,  10606,  10573,  10540,  10508,
 10475,  10442,  10409,  10376,  10344,  10311,  10278,  10245,  10213,  10180,  10147,  10114,  10081,  10049,  10016,   9983,   9950,   9917,   9885,   9852,
  9819,   9786,   9754,   9721,   9688,   9655,   9622,   9590,   9557,   9524,   9491,   9459,   9426,   9393,   9360,   9327,   9295,   9262,   9229,   9196,
  9163,   9131,   9098,   9065,   9032,   9000,   8967,   8934,   8901,   8868,   8836,   8803,   8770,   8737,   8704,   8672,   8639,   8606,   8573,   8541,
  8508,   8475,   8442,   8409,   8377,   8344,   8311,   8278,   8246,   8213,   8180,   8147,   8114,   8082,   8049,   8016,   7983,   7950,   7918,   7885,
  7852,   7819,   7787,   7754,   7721,   7688,   7655,   7623,   7590,   7557,   7524,   7492,   7459,   7426,   7393,   7360,   7328,   7295,   7262,   7229,
  7196,   7164,   7131,   7098,   7065,   7033,   7000,   6967,   6934,   6901,   6869,   6836,   6803,   6770,   6737,   6705,   6672,   6639,   6606,   6574,
  6541,   6508,   6475,   6442,   6410,   6377,   6344,   6311,   6279,   6246,   6213,   6180,   6147,   6115,   6082,   6049,   6016,   5983,   5951,   5918,
  5885,   5852,   5820,   5787,   5754,   5721,   5688,   5656,   5623,   5590,   5557,   5525,   5492,   5459,   5426,   5393,   5361,   5328,   5295,   5262,
  5229,   5197,   5164,   5131,   5098,   5066,   5033,   5000,   4967,   4934,   4902,   4869,   4836,   4803,   4770,   4738,   4705,   4672,   4639,   4607,
  4574,   4541,   4508,   4475,   4443,   4410,   4377,   4344,   4312,   4279,   4246,   4213,   4180,   4148,   4115,   4082,   4049,   4016,   3984,   3951,
  3918,   3885,   3853,   3820,   3787,   3754,   3721,   3689,   3656,   3623,   3590,   3558,   3525,   3492,   3459,   3426,   3394,   3361,   3328,   3295,
  3262,   3230,   3197,   3164,   3131,   3099,   3066,   3033,   3000,   2967,   2935,   2902,   2869,   2836,   2803,   2771,   2738,   2705,   2672,   2640,
  2607,   2574,   2541,   2508,   2476,   2443,   2410,   2377,   2345,   2312,   2279,   2246,   2213,   2181,   2148,   2115,   2082,   2049,   2017,   1984,
  1951,   1918,   1886,   1853,   1820,   1787,   1754,   1722,   1689,   1656,   1623,   1590,   1558,   1525,   1492,   1459,   1427,   1394,   1361,   1328,
  1295,   1263,   1230,   1197,   1164,   1132,   1099,   1066,   1033,   1000,    968,    935,    902,    869,    836,    804,    771,    738,    705,    673,
   640,    607,    574,    541,    509,    476,    443,    410,    378,    345,    312,    279,    246,    214,    181,    148,    115,     82,     50,     17,
   -15,    -48,    -80,   -113,   -146,   -179,   -212,   -244,   -277,   -310,   -343,   -376,   -408,   -441,   -474,   -507,   -539,   -572,   -605,   -638,
  -671,   -703,   -736,   -769,   -802,   -834,   -867,   -900,   -933,   -966,   -998,  -1031,  -1064,  -1097,  -1130,  -1162,  -1195,  -1228,  -1261,  -1293,
 -1326,  -1359,  -1392,  -1425,  -1457,  -1490,  -1523,  -1556,  -1588,  -1621,  -1654,  -1687,  -1720,  -1752,  -1785,  -1818,  -1851,  -1884,  -1916,  -1949,
 -1982,  -2015,  -2047,  -2080,  -2113,  -2146,  -2179,  -2211,  -2244,  -2277,  -2310,  -2343,  -2375,  -2408,  -2441,  -2474,  -2506,  -2539,  -2572,  -2605,
 -2638,  -2670,  -2703,  -2736,  -2769,  -2801,  -2834,  -2867,  -2900,  -2933,  -2965,  -2998,  -3031,  -3064,  -3097,  -3129,  -3162,  -3195,  -3228,  -3260,
 -3293,  -3326,  -3359,  -3392,  -3424,  -3457,  -3490,  -3523,  -3555,  -3588,  -3621,  -3654,  -3687,  -3719,  -3752,  -3785,  -3818,  -3851,  -3883,  -3916,
 -3949,  -3982,  -4014,  -4047,  -4080,  -4113,  -4146,  -4178,  -4211,  -4244,  -4277,  -4310,  -4342,  -4375,  -4408,  -4441,  -4473,  -4506,  -4539,  -4572,
 -4605,  -4637,  -4670,  -4703,  -4736,  -4768,  -4801,  -4834,  -4867,  -4900,  -4932,  -4965,  -4998,  -5031,  -5064,  -5096,  -5129,  -5162,  -5195,  -5227,
 -5260,  -5293,  -5326,  -5359,  -5391,  -5424,  -5457,  -5490,  -5523,  -5555,  -5588,  -5621,  -5654,  -5686,  -5719,  -5752,  -5785,  -5818,  -5850,  -5883,
 -5916,  -5949,  -5981,  -6014,  -6047,  -6080,  -6113,  -6145,  -6178,  -6211,  -6244,  -6277,  -6309,  -6342,  -6375,  -6408,  -6440,  -6473,  -6506,  -6539,
 -6572,  -6604,  -6637,  -6670,  -6703,  -6735,  -6768,  -6801,  -6834,  -6867,  -6899,  -6932,  -6965,  -6998,  -7031,  -7063,  -7096,  -7129,  -7162,  -7194,
 -7227,  -7260,  -7293,  -7326,  -7358,  -7391,  -7424,  -7457,  -7490,  -7522,  -7555,  -7588,  -7621,  -7653,  -7686,  -7719,  -7752,  -7785,  -7817,  -7850,
 -7883,  -7916,  -7948,  -7981,  -8014,  -8047,  -8080,  -8112,  -8145,  -8178,  -8211,  -8244,  -8276,  -8309,  -8342,  -8375,  -8407,  -8440,  -8473,  -8506,
 -8539,  -8571,  -8604,  -8637,  -8670,  -8702,  -8735,  -8768,  -8801,  -8834,  -8866,  -8899,  -8932,  -8965,  -8998,  -9030,  -9063,  -9096,  -9129,  -9161,
 -9194,  -9227,  -9260,  -9293,  -9325,  -9358,  -9391,  -9424,  -9457,  -9489,  -9522,  -9555,  -9588,  -9620,  -9653,  -9686,  -9719,  -9752,  -9784,  -9817,
 -9850,  -9883,  -9915,  -9948,  -9981, -10014, -10047, -10079, -10112, -10145, -10178, -10211, -10243, -10276, -10309, -10342, -10374, -10407, -10440, -10473,
-10506, -10538, -10571, -10604, -10637, -10669, -10702, -10735, -10768, -10801, -10833, -10866, -10899, -10932, -10965, -10997, -11030, -11063, -11096, -11128,
-11161, -11194, -11227, -11260, -11292, -11325, -11358, -11391, -11424, -11456, -11489, -11522, -11555, -11587, -11620, -11653, -11686, -11719, -11751, -11784,
-11817, -11850, -11882, -11915, -11948, -11981, -12014, -12046, -12079, -12112, -12145, -12178, -12210, -12243, -12276, -12309, -12341, -12374, -12407, -12440,
-12473, -12505, -12538, -12571, -12604, -12636, -12669, -12702, -12735, -12768, -12800, -12833, -12866, -12899, -12932, -12964, -12997, -13030, -13063, -13095,
-13128, -13161, -13194, -13227, -13259, -13292, -13325, -13358, -13391, -13423, -13456, -13489, -13522, -13554, -13587, -13620, -13653, -13686, -13718, -13751,
-13784, -13817, -13849, -13882, -13915, -13948, -13981, -14013, -14046, -14079, -14112, -14145, -14177, -14210, -14243, -14276, -14308, -14341, -14374, -14407,
-14440, -14472, -14505, -14538, -14571, -14604, -14636, -14669, -14702, -14735, -14767, -14800, -14833, -14866, -14899, -14931, -14964, -14997, -15030, -15062,
-15095, -15128, -15161, -15194, -15226, -15259, -15292, -15325, -15358, -15390, -15423, -15456, -15489, -15521, -15554, -15587, -15620, -15653, -15685, -15718,
-15751, -15784, -15816, -15849, -15882, -15915, -15948, -15980, -16013, -16046, -16079, -16112, -16144, -16177, -16210, -16243, -16275, -16308, -16341, -16374,
-16407, -16439, -16472, -16505, -16538, -16571, -16603, -16636, -16669, -16702, -16734, -16767, -16800, -16833, -16866, -16898, -16931, -16964, -16997, -17029,
-17062, -17095, -17128, -17161, -17193, -17226, -17259, -17292, -17325, -17357, -17390, -17423, -17456, -17488, -17521, -17554, -17587, -17620, -17652, -17685,
-17718, -17751, -17783, -17816, -17849, -17882, -17915, -17947, -17980, -18013, -18046, -18079, -18111, -18144, -18177, -18210, -18242, -18275, -18308, -18341,
-18374, -18406, -18439, -18472, -18505, -18538, -18570, -18603, -18636, -18669, -18701, -18734, -18767, -18800, -18833, -18865, -18898, -18931, -18964, -18996,
-19029, -19062, -19095, -19128, -19160, -19193, -19226, -19259, -19292, -19324, -19357, -19390, -19423, -19455, -19488, -19521, -19554, -19587, -19619, -19652,
-19685, -19718, -19750, -19783, -19816, -19849, -19882, -19914, -19947, -19980, -20013, -20046, -20078, -20111, -20144, -20177, -20209, -20242, -20275, -20308,
-20341, -20373, -20406, -20439, -20472, -20505, -20537, -20570, -20603, -20636, -20668, -20701, -20734, -20767, -20800, -20832, -20865, -20898, -20931, -20963,
-20996, -21029, -21062, -21095, -21127, -21160, -21193, -21226, -21259, -21291, -21324, -21357, -21390, -21422, -21455, -21488, -21521, -21554, -21586, -21619,
-21652, -21685, -21717, -21750, -21783, -21816, -21849, -21881, -21914, -21947, -21980, -22013, -22045, -22078, -22111, -22144, -22176, -22209, -22242, -22275,
-22308, -22340, -22373, -22406, -22439, -22472, -22504, -22537, -22570, -22603, -22635, -22668, -22701, -22734, -22767, -22799, -22832, -22865, -22898, -22930,
-22963, -22996, -23029, -23062, -23094, -23127, -23160, -23193, -23226, -23258, -23291, -23324, -23357, -23389, -23422, -23455, -23488, -23521, -23553, -23586,
-23619, -23652, -23684, -23717, -23750, -23783, -23816, -23848, -23881, -23914, -23947, -23980, -24012, -24045, -24078, -24111, -24143, -24176, -24209, -24242,
-24275, -24307, -24340, -24373, -24406, -24439, -24471, -24504, -24537, -24570, -24602, -24635, -24668, -24701, -24734, -24766, -24799, -24832, -24865, -24897,
-24930, -24963, -24996, -25029, -25061, -25094, -25127, -25160, -25193, -25225, -25258, -25291, -25324, -25356, -25389, -25422, -25455, -25488, -25520, -25553,
-25586, -25619, -25652, -25684, -25717, -25750, -25783, -25815, -25848, -25881, -25914, -25947, -25979, -26012, -26045, -26078, -26110, -26143, -26176, -26209,
-26242, -26274, -26307, -26340, -26373, -26406, -26438, -26471, -26504, -26537, -26569, -26602, -26635, -26668, -26701, -26733, -26766, -26799, -26832, -26864,
-26897, -26930, -26963, -26996, -27028, -27061, -27094, -27127, -27160, -27192, -27225, -27258, -27291, -27323, -27356, -27389, -27422, -27455, -27487, -27520,
-27553, -27586, -27619, -27651, -27684, -27717, -27750, -27782, -27815, -27848, -27881, -27914, -27946, -27979, -28012, -28045, -28077, -28110, -28143, -28176,
-28209, -28241, -28274, -28307, -28340, -28373, -28405, -28438, -28471, -28504, -28536, -28569, -28602, -28635, -28668, -28700, -28733, -28766, -28799, -28831,
-28864, -28897, -28930, -28963, -28995, -29028, -29061, -29094, -29127, -29159, -29192, -29225, -29258, -29290, -29323, -29356, -29389, -29422, -29454, -29487,
-29520, -29553, -29586, -29618, -29651, -29684, -29717, -29749, -29782, -29815, -29848, -29881, -29913, -29946, -29979, -30012, -30044, -30077, -30110, -30143,
-30176, -30208, -30241, -30274, -30307, -30340, -30372, -30405, -30438, -30471, -30503, -30536, -30569, -30602, -30635, -30667, -30700, -30733, -30766, -30798,
-30831, -30864, -30897, -30930, -30962, -30995, -31028, -31061, -31094, -31126, -31159, -31192, -31225, -31257, -31290, -31323, -31356, -31389, -31421, -31454,
-31487, -31520, -31553, -31585, -31618, -31651, -31684, -31716, -31749, -31782, -31815, -31848, -31880, -31913, -31946, -31979, -32011, -32044, -32077, -32110,
-32143, -32175, -32208, -32241, -32274, -32307, -32339, -32372, -32405, -32438, -32470, -32503, -32536, -32569, -32602, -32634, -32667, -32700, -32733, -32765,
};

int16_t lut_l[LUTSIZE] = {
     0,    102,    205,    308,    411,    514,    617,    720,    823,    926,   1029,   1132,   1234,   1337,   1440,   1543,   1646,   1749,   1851,   1954,
  2057,   2160,   2262,   2365,   2468,   2570,   2673,   2776,   2878,   2981,   3083,   3186,   3288,   3390,   3493,   3595,   3697,   3800,   3902,   4004,
  4106,   4208,   4310,   4412,   4514,   4616,   4718,   4820,   4922,   5024,   5125,   5227,   5329,   5430,   5532,   5633,   5734,   5836,   5937,   6038,
  6139,   6241,   6342,   6442,   6543,   6644,   6745,   6846,   6946,   7047,   7147,   7248,   7348,   7448,   7549,   7649,   7749,   7849,   7949,   8049,
  8148,   8248,   8348,   8447,   8546,   8646,   8745,   8844,   8943,   9042,   9141,   9240,   9339,   9437,   9536,   9634,   9733,   9831,   9929,  10027,
 10125,  10223,  10321,  10418,  10516,  10613,  10711,  10808,  10905,  11002,  11099,  11196,  11292,  11389,  11485,  11582,  11678,  11774,  11870,  11966,
 12062,  12157,  12253,  12348,  12444,  12539,  12634,  12729,  12824,  12918,  13013,  13107,  13202,  13296,  13390,  13484,  13577,  13671,  13764,  13858,
 13951,  14044,  14137,  14230,  14322,  14415,  14507,  14600,  14692,  14784,  14875,  14967,  15059,  15150,  15241,  15332,  15423,  15514,  15604,  15695,
 15785,  15875,  15965,  16055,  16145,  16234,  16324,  16413,  16502,  16591,  16679,  16768,  16856,  16944,  17032,  17120,  17208,  17295,  17383,  17470,
 17557,  17644,  17730,  17817,  17903,  17989,  18075,  18161,  18247,  18332,  18417,  18502,  18587,  18672,  18756,  18841,  18925,  19009,  19093,  19176,
 19259,  19343,  19426,  19508,  19591,  19673,  19756,  19838,  19920,  20001,  20083,  20164,  20245,  20326,  20406,  20487,  20567,  20647,  20727,  20807,
 20886,  20965,  21044,  21123,  21202,  21280,  21358,  21436,  21514,  21591,  21669,  21746,  21823,  21899,  21976,  22052,  22128,  22204,  22280,  22355,
 22430,  22505,  22580,  22654,  22728,  22802,  22876,  22950,  23023,  23096,  23169,  23242,  23314,  23387,  23459,  23530,  23602,  23673,  23744,  23815,
 23886,  23956,  24026,  24096,  24166,  24235,  24304,  24373,  24442,  24510,  24578,  24646,  24714,  24782,  24849,  24916,  24982,  25049,  25115,  25181,
 25247,  25312,  25378,  25443,  25507,  25572,  25636,  25700,  25764,  25827,  25891,  25953,  26016,  26079,  26141,  26203,  26264,  26326,  26387,  26448,
 26509,  26569,  26629,  26689,  26748,  26808,  26867,  26926,  26984,  27042,  27100,  27158,  27216,  27273,  27330,  27386,  27443,  27499,  27555,  27610,
 27666,  27721,  27775,  27830,  27884,  27938,  27992,  28045,  28098,  28151,  28203,  28256,  28308,  28359,  28411,  28462,  28513,  28563,  28614,  28664,
 28713,  28763,  28812,  28861,  28910,  28958,  29006,  29054,  29101,  29148,  29195,  29242,  29288,  29334,  29380,  29425,  29470,  29515,  29560,  29604,
 29648,  29692,  29735,  29778,  29821,  29863,  29906,  29948,  29989,  30031,  30072,  30112,  30153,  30193,  30233,  30272,  30312,  30350,  30389,  30427,
 30465,  30503,  30541,  30578,  30615,  30651,  30687,  30723,  30759,  30794,  30829,  30864,  30898,  30933,  30966,  31000,  31033,  31066,  31099,  31131,
 31163,  31194,  31226,  31257,  31288,  31318,  31348,  31378,  31407,  31437,  31465,  31494,  31522,  31550,  31578,  31605,  31632,  31659,  31685,  31711,
 31737,  31763,  31788,  31812,  31837,  31861,  31885,  31909,  31932,  31955,  31977,  32000,  32022,  32043,  32065,  32086,  32106,  32127,  32147,  32167,
 32186,  32205,  32224,  32243,  32261,  32279,  32296,  32313,  32330,  32347,  32363,  32379,  32395,  32410,  32425,  32440,  32454,  32468,  32482,  32495,
 32508,  32521,  32533,  32545,  32557,  32569,  32580,  32591,  32601,  32611,  32621,  32631,  32640,  32649,  32657,  32665,  32673,  32681,  32688,  32695,
 32702,  32708,  32714,  32720,  32725,  32730,  32735,  32739,  32743,  32747,  32750,  32753,  32756,  32759,  32761,  32762,  32764,  32765,  32766,  32766,
 32767,  32766,  32766,  32765,  32764,  32762,  32761,  32759,  32756,  32753,  32750,  32747,  32743,  32739,  32735,  32730,  32725,  32720,  32714,  32708,
 32702,  32695,  32688,  32681,  32673,  32665,  32657,  32649,  32640,  32631,  32621,  32611,  32601,  32591,  32580,  32569,  32557,  32545,  32533,  32521,
 32508,  32495,  32482,  32468,  32454,  32440,  32425,  32410,  32395,  32379,  32363,  32347,  32330,  32313,  32296,  32279,  32261,  32243,  32224,  32205,
 32186,  32167,  32147,  32127,  32106,  32086,  32065,  32043,  32022,  32000,  31977,  31955,  31932,  31909,  31885,  31861,  31837,  31812,  31788,  31763,
 31737,  31711,  31685,  31659,  31632,  31605,  31578,  31550,  31522,  31494,  31465,  31437,  31407,  31378,  31348,  31318,  31288,  31257,  31226,  31194,
 31163,  31131,  31099,  31066,  31033,  31000,  30966,  30933,  30898,  30864,  30829,  30794,  30759,  30723,  30687,  30651,  30615,  30578,  30541,  30503,
 30465,  30427,  30389,  30350,  30312,  30272,  30233,  30193,  30153,  30112,  30072,  30031,  29989,  29948,  29906,  29863,  29821,  29778,  29735,  29692,
 29648,  29604,  29560,  29515,  29470,  29425,  29380,  29334,  29288,  29242,  29195,  29148,  29101,  29054,  29006,  28958,  28910,  28861,  28812,  28763,
 28713,  28664,  28614,  28563,  28513,  28462,  28411,  28359,  28308,  28256,  28203,  28151,  28098,  28045,  27992,  27938,  27884,  27830,  27775,  27721,
 27666,  27610,  27555,  27499,  27443,  27386,  27330,  27273,  27216,  27158,  27100,  27042,  26984,  26926,  26867,  26808,  26748,  26689,  26629,  26569,
 26509,  26448,  26387,  26326,  26264,  26203,  26141,  26079,  26016,  25953,  25891,  25827,  25764,  25700,  25636,  25572,  25507,  25443,  25378,  25312,
 25247,  25181,  25115,  25049,  24982,  24916,  24849,  24782,  24714,  24646,  24578,  24510,  24442,  24373,  24304,  24235,  24166,  24096,  24026,  23956,
 23886,  23815,  23744,  23673,  23602,  23530,  23459,  23387,  23314,  23242,  23169,  23096,  23023,  22950,  22876,  22802,  22728,  22654,  22580,  22505,
 22430,  22355,  22280,  22204,  22128,  22052,  21976,  21899,  21823,  21746,  21669,  21591,  21514,  21436,  21358,  21280,  21202,  21123,  21044,  20965,
 20886,  20807,  20727,  20647,  20567,  20487,  20406,  20326,  20245,  20164,  20083,  20001,  19920,  19838,  19756,  19673,  19591,  19508,  19426,  19343,
 19259,  19176,  19093,  19009,  18925,  18841,  18756,  18672,  18587,  18502,  18417,  18332,  18247,  18161,  18075,  17989,  17903,  17817,  17730,  17644,
 17557,  17470,  17383,  17295,  17208,  17120,  17032,  16944,  16856,  16768,  16679,  16591,  16502,  16413,  16324,  16234,  16145,  16055,  15965,  15875,
 15785,  15695,  15604,  15514,  15423,  15332,  15241,  15150,  15059,  14967,  14875,  14784,  14692,  14600,  14507,  14415,  14322,  14230,  14137,  14044,
 13951,  13858,  13764,  13671,  13577,  13484,  13390,  13296,  13202,  13107,  13013,  12918,  12824,  12729,  12634,  12539,  12444,  12348,  12253,  12157,
 12062,  11966,  11870,  11774,  11678,  11582,  11485,  11389,  11292,  11196,  11099,  11002,  10905,  10808,  10711,  10613,  10516,  10418,  10321,  10223,
 10125,  10027,   9929,   9831,   9733,   9634,   9536,   9437,   9339,   9240,   9141,   9042,   8943,   8844,   8745,   8646,   8546,   8447,   8348,   8248,
  8148,   8049,   7949,   7849,   7749,   7649,   7549,   7448,   7348,   7248,   7147,   7047,   6946,   6846,   6745,   6644,   6543,   6442,   6342,   6241,
  6139,   6038,   5937,   5836,   5734,   5633,   5532,   5430,   5329,   5227,   5125,   5024,   4922,   4820,   4718,   4616,   4514,   4412,   4310,   4208,
  4106,   4004,   3902,   3800,   3697,   3595,   3493,   3390,   3288,   3186,   3083,   2981,   2878,   2776,   2673,   2570,   2468,   2365,   2262,   2160,
  2057,   1954,   1851,   1749,   1646,   1543,   1440,   1337,   1234,   1132,   1029,    926,    823,    720,    617,    514,    411,    308,    205,    102,
     0,   -102,   -205,   -308,   -411,   -514,   -617,   -720,   -823,   -926,  -1029,  -1132,  -1234,  -1337,  -1440,  -1543,  -1646,  -1749,  -1851,  -1954,
 -2057,  -2160,  -2262,  -2365,  -2468,  -2570,  -2673,  -2776,  -2878,  -2981,  -3083,  -3186,  -3288,  -3390,  -3493,  -3595,  -3697,  -3800,  -3902,  -4004,
 -4106,  -4208,  -4310,  -4412,  -4514,  -4616,  -4718,  -4820,  -4922,  -5024,  -5125,  -5227,  -5329,  -5430,  -5532,  -5633,  -5734,  -5836,  -5937,  -6038,
 -6139,  -6241,  -6342,  -6442,  -6543,  -6644,  -6745,  -6846,  -6946,  -7047,  -7147,  -7248,  -7348,  -7448,  -7549,  -7649,  -7749,  -7849,  -7949,  -8049,
 -8148,  -8248,  -8348,  -8447,  -8546,  -8646,  -8745,  -8844,  -8943,  -9042,  -9141,  -9240,  -9339,  -9437,  -9536,  -9634,  -9733,  -9831,  -9929, -10027,
-10125, -10223, -10321, -10418, -10516, -10613, -10711, -10808, -10905, -11002, -11099, -11196, -11292, -11389, -11485, -11582, -11678, -11774, -11870, -11966,
-12062, -12157, -12253, -12348, -12444, -12539, -12634, -12729, -12824, -12918, -13013, -13107, -13202, -13296, -13390, -13484, -13577, -13671, -13764, -13858,
-13951, -14044, -14137, -14230, -14322, -14415, -14507, -14600, -14692, -14784, -14875, -14967, -15059, -15150, -15241, -15332, -15423, -15514, -15604, -15695,
-15785, -15875, -15965, -16055, -16145, -16234, -16324, -16413, -16502, -16591, -16679, -16768, -16856, -16944, -17032, -17120, -17208, -17295, -17383, -17470,
-17557, -17644, -17730, -17817, -17903, -17989, -18075, -18161, -18247, -18332, -18417, -18502, -18587, -18672, -18756, -18841, -18925, -19009, -19093, -19176,
-19259, -19343, -19426, -19508, -19591, -19673, -19756, -19838, -19920, -20001, -20083, -20164, -20245, -20326, -20406, -20487, -20567, -20647, -20727, -20807,
-20886, -20965, -21044, -21123, -21202, -21280, -21358, -21436, -21514, -21591, -21669, -21746, -21823, -21899, -21976, -22052, -22128, -22204, -22280, -22355,
-22430, -22505, -22580, -22654, -22728, -22802, -22876, -22950, -23023, -23096, -23169, -23242, -23314, -23387, -23459, -23530, -23602, -23673, -23744, -23815,
-23886, -23956, -24026, -24096, -24166, -24235, -24304, -24373, -24442, -24510, -24578, -24646, -24714, -24782, -24849, -24916, -24982, -25049, -25115, -25181,
-25247, -25312, -25378, -25443, -25507, -25572, -25636, -25700, -25764, -25827, -25891, -25953, -26016, -26079, -26141, -26203, -26264, -26326, -26387, -26448,
-26509, -26569, -26629, -26689, -26748, -26808, -26867, -26926, -26984, -27042, -27100, -27158, -27216, -27273, -27330, -27386, -27443, -27499, -27555, -27610,
-27666, -27721, -27775, -27830, -27884, -27938, -27992, -28045, -28098, -28151, -28203, -28256, -28308, -28359, -28411, -28462, -28513, -28563, -28614, -28664,
-28713, -28763, -28812, -28861, -28910, -28958, -29006, -29054, -29101, -29148, -29195, -29242, -29288, -29334, -29380, -29425, -29470, -29515, -29560, -29604,
-29648, -29692, -29735, -29778, -29821, -29863, -29906, -29948, -29989, -30031, -30072, -30112, -30153, -30193, -30233, -30272, -30312, -30350, -30389, -30427,
-30465, -30503, -30541, -30578, -30615, -30651, -30687, -30723, -30759, -30794, -30829, -30864, -30898, -30933, -30966, -31000, -31033, -31066, -31099, -31131,
-31163, -31194, -31226, -31257, -31288, -31318, -31348, -31378, -31407, -31437, -31465, -31494, -31522, -31550, -31578, -31605, -31632, -31659, -31685, -31711,
-31737, -31763, -31788, -31812, -31837, -31861, -31885, -31909, -31932, -31955, -31977, -32000, -32022, -32043, -32065, -32086, -32106, -32127, -32147, -32167,
-32186, -32205, -32224, -32243, -32261, -32279, -32296, -32313, -32330, -32347, -32363, -32379, -32395, -32410, -32425, -32440, -32454, -32468, -32482, -32495,
-32508, -32521, -32533, -32545, -32557, -32569, -32580, -32591, -32601, -32611, -32621, -32631, -32640, -32649, -32657, -32665, -32673, -32681, -32688, -32695,
-32702, -32708, -32714, -32720, -32725, -32730, -32735, -32739, -32743, -32747, -32750, -32753, -32756, -32759, -32761, -32762, -32764, -32765, -32766, -32766,
-32767, -32766, -32766, -32765, -32764, -32762, -32761, -32759, -32756, -32753, -32750, -32747, -32743, -32739, -32735, -32730, -32725, -32720, -32714, -32708,
-32702, -32695, -32688, -32681, -32673, -32665, -32657, -32649, -32640, -32631, -32621, -32611, -32601, -32591, -32580, -32569, -32557, -32545, -32533, -32521,
-32508, -32495, -32482, -32468, -32454, -32440, -32425, -32410, -32395, -32379, -32363, -32347, -32330, -32313, -32296, -32279, -32261, -32243, -32224, -32205,
-32186, -32167, -32147, -32127, -32106, -32086, -32065, -32043, -32022, -32000, -31977, -31955, -31932, -31909, -31885, -31861, -31837, -31812, -31788, -31763,
-31737, -31711, -31685, -31659, -31632, -31605, -31578, -31550, -31522, -31494, -31465, -31437, -31407, -31378, -31348, -31318, -31288, -31257, -31226, -31194,
-31163, -31131, -31099, -31066, -31033, -31000, -30966, -30933, -30898, -30864, -30829, -30794, -30759, -30723, -30687, -30651, -30615, -30578, -30541, -30503,
-30465, -30427, -30389, -30350, -30312, -30272, -30233, -30193, -30153, -30112, -30072, -30031, -29989, -29948, -29906, -29863, -29821, -29778, -29735, -29692,
-29648, -29604, -29560, -29515, -29470, -29425, -29380, -29334, -29288, -29242, -29195, -29148, -29101, -29054, -29006, -28958, -28910, -28861, -28812, -28763,
-28713, -28664, -28614, -28563, -28513, -28462, -28411, -28359, -28308, -28256, -28203, -28151, -28098, -28045, -27992, -27938, -27884, -27830, -27775, -27721,
-27666, -27610, -27555, -27499, -27443, -27386, -27330, -27273, -27216, -27158, -27100, -27042, -26984, -26926, -26867, -26808, -26748, -26689, -26629, -26569,
-26509, -26448, -26387, -26326, -26264, -26203, -26141, -26079, -26016, -25953, -25891, -25827, -25764, -25700, -25636, -25572, -25507, -25443, -25378, -25312,
-25247, -25181, -25115, -25049, -24982, -24916, -24849, -24782, -24714, -24646, -24578, -24510, -24442, -24373, -24304, -24235, -24166, -24096, -24026, -23956,
-23886, -23815, -23744, -23673, -23602, -23530, -23459, -23387, -23314, -23242, -23169, -23096, -23023, -22950, -22876, -22802, -22728, -22654, -22580, -22505,
-22430, -22355, -22280, -22204, -22128, -22052, -21976, -21899, -21823, -21746, -21669, -21591, -21514, -21436, -21358, -21280, -21202, -21123, -21044, -20965,
-20886, -20807, -20727, -20647, -20567, -20487, -20406, -20326, -20245, -20164, -20083, -20001, -19920, -19838, -19756, -19673, -19591, -19508, -19426, -19343,
-19259, -19176, -19093, -19009, -18925, -18841, -18756, -18672, -18587, -18502, -18417, -18332, -18247, -18161, -18075, -17989, -17903, -17817, -17730, -17644,
-17557, -17470, -17383, -17295, -17208, -17120, -17032, -16944, -16856, -16768, -16679, -16591, -16502, -16413, -16324, -16234, -16145, -16055, -15965, -15875,
-15785, -15695, -15604, -15514, -15423, -15332, -15241, -15150, -15059, -14967, -14875, -14784, -14692, -14600, -14507, -14415, -14322, -14230, -14137, -14044,
-13951, -13858, -13764, -13671, -13577, -13484, -13390, -13296, -13202, -13107, -13013, -12918, -12824, -12729, -12634, -12539, -12444, -12348, -12253, -12157,
-12062, -11966, -11870, -11774, -11678, -11582, -11485, -11389, -11292, -11196, -11099, -11002, -10905, -10808, -10711, -10613, -10516, -10418, -10321, -10223,
-10125, -10027,  -9929,  -9831,  -9733,  -9634,  -9536,  -9437,  -9339,  -9240,  -9141,  -9042,  -8943,  -8844,  -8745,  -8646,  -8546,  -8447,  -8348,  -8248,
 -8148,  -8049,  -7949,  -7849,  -7749,  -7649,  -7549,  -7448,  -7348,  -7248,  -7147,  -7047,  -6946,  -6846,  -6745,  -6644,  -6543,  -6442,  -6342,  -6241,
 -6139,  -6038,  -5937,  -5836,  -5734,  -5633,  -5532,  -5430,  -5329,  -5227,  -5125,  -5024,  -4922,  -4820,  -4718,  -4616,  -4514,  -4412,  -4310,  -4208,
 -4106,  -4004,  -3902,  -3800,  -3697,  -3595,  -3493,  -3390,  -3288,  -3186,  -3083,  -2981,  -2878,  -2776,  -2673,  -2570,  -2468,  -2365,  -2262,  -2160,
 -2057,  -1954,  -1851,  -1749,  -1646,  -1543,  -1440,  -1337,  -1234,  -1132,  -1029,   -926,   -823,   -720,   -617,   -514,   -411,   -308,   -205,   -102,
};
int16_t lut_r[LUTSIZE] = {
     0,    102,    205,    308,    411,    514,    617,    720,    823,    926,   1029,   1132,   1234,   1337,   1440,   1543,   1646,   1749,   1851,   1954,
  2057,   2160,   2262,   2365,   2468,   2570,   2673,   2776,   2878,   2981,   3083,   3186,   3288,   3390,   3493,   3595,   3697,   3800,   3902,   4004,
  4106,   4208,   4310,   4412,   4514,   4616,   4718,   4820,   4922,   5024,   5125,   5227,   5329,   5430,   5532,   5633,   5734,   5836,   5937,   6038,
  6139,   6241,   6342,   6442,   6543,   6644,   6745,   6846,   6946,   7047,   7147,   7248,   7348,   7448,   7549,   7649,   7749,   7849,   7949,   8049,
  8148,   8248,   8348,   8447,   8546,   8646,   8745,   8844,   8943,   9042,   9141,   9240,   9339,   9437,   9536,   9634,   9733,   9831,   9929,  10027,
 10125,  10223,  10321,  10418,  10516,  10613,  10711,  10808,  10905,  11002,  11099,  11196,  11292,  11389,  11485,  11582,  11678,  11774,  11870,  11966,
 12062,  12157,  12253,  12348,  12444,  12539,  12634,  12729,  12824,  12918,  13013,  13107,  13202,  13296,  13390,  13484,  13577,  13671,  13764,  13858,
 13951,  14044,  14137,  14230,  14322,  14415,  14507,  14600,  14692,  14784,  14875,  14967,  15059,  15150,  15241,  15332,  15423,  15514,  15604,  15695,
 15785,  15875,  15965,  16055,  16145,  16234,  16324,  16413,  16502,  16591,  16679,  16768,  16856,  16944,  17032,  17120,  17208,  17295,  17383,  17470,
 17557,  17644,  17730,  17817,  17903,  17989,  18075,  18161,  18247,  18332,  18417,  18502,  18587,  18672,  18756,  18841,  18925,  19009,  19093,  19176,
 19259,  19343,  19426,  19508,  19591,  19673,  19756,  19838,  19920,  20001,  20083,  20164,  20245,  20326,  20406,  20487,  20567,  20647,  20727,  20807,
 20886,  20965,  21044,  21123,  21202,  21280,  21358,  21436,  21514,  21591,  21669,  21746,  21823,  21899,  21976,  22052,  22128,  22204,  22280,  22355,
 22430,  22505,  22580,  22654,  22728,  22802,  22876,  22950,  23023,  23096,  23169,  23242,  23314,  23387,  23459,  23530,  23602,  23673,  23744,  23815,
 23886,  23956,  24026,  24096,  24166,  24235,  24304,  24373,  24442,  24510,  24578,  24646,  24714,  24782,  24849,  24916,  24982,  25049,  25115,  25181,
 25247,  25312,  25378,  25443,  25507,  25572,  25636,  25700,  25764,  25827,  25891,  25953,  26016,  26079,  26141,  26203,  26264,  26326,  26387,  26448,
 26509,  26569,  26629,  26689,  26748,  26808,  26867,  26926,  26984,  27042,  27100,  27158,  27216,  27273,  27330,  27386,  27443,  27499,  27555,  27610,
 27666,  27721,  27775,  27830,  27884,  27938,  27992,  28045,  28098,  28151,  28203,  28256,  28308,  28359,  28411,  28462,  28513,  28563,  28614,  28664,
 28713,  28763,  28812,  28861,  28910,  28958,  29006,  29054,  29101,  29148,  29195,  29242,  29288,  29334,  29380,  29425,  29470,  29515,  29560,  29604,
 29648,  29692,  29735,  29778,  29821,  29863,  29906,  29948,  29989,  30031,  30072,  30112,  30153,  30193,  30233,  30272,  30312,  30350,  30389,  30427,
 30465,  30503,  30541,  30578,  30615,  30651,  30687,  30723,  30759,  30794,  30829,  30864,  30898,  30933,  30966,  31000,  31033,  31066,  31099,  31131,
 31163,  31194,  31226,  31257,  31288,  31318,  31348,  31378,  31407,  31437,  31465,  31494,  31522,  31550,  31578,  31605,  31632,  31659,  31685,  31711,
 31737,  31763,  31788,  31812,  31837,  31861,  31885,  31909,  31932,  31955,  31977,  32000,  32022,  32043,  32065,  32086,  32106,  32127,  32147,  32167,
 32186,  32205,  32224,  32243,  32261,  32279,  32296,  32313,  32330,  32347,  32363,  32379,  32395,  32410,  32425,  32440,  32454,  32468,  32482,  32495,
 32508,  32521,  32533,  32545,  32557,  32569,  32580,  32591,  32601,  32611,  32621,  32631,  32640,  32649,  32657,  32665,  32673,  32681,  32688,  32695,
 32702,  32708,  32714,  32720,  32725,  32730,  32735,  32739,  32743,  32747,  32750,  32753,  32756,  32759,  32761,  32762,  32764,  32765,  32766,  32766,
 32767,  32766,  32766,  32765,  32764,  32762,  32761,  32759,  32756,  32753,  32750,  32747,  32743,  32739,  32735,  32730,  32725,  32720,  32714,  32708,
 32702,  32695,  32688,  32681,  32673,  32665,  32657,  32649,  32640,  32631,  32621,  32611,  32601,  32591,  32580,  32569,  32557,  32545,  32533,  32521,
 32508,  32495,  32482,  32468,  32454,  32440,  32425,  32410,  32395,  32379,  32363,  32347,  32330,  32313,  32296,  32279,  32261,  32243,  32224,  32205,
 32186,  32167,  32147,  32127,  32106,  32086,  32065,  32043,  32022,  32000,  31977,  31955,  31932,  31909,  31885,  31861,  31837,  31812,  31788,  31763,
 31737,  31711,  31685,  31659,  31632,  31605,  31578,  31550,  31522,  31494,  31465,  31437,  31407,  31378,  31348,  31318,  31288,  31257,  31226,  31194,
 31163,  31131,  31099,  31066,  31033,  31000,  30966,  30933,  30898,  30864,  30829,  30794,  30759,  30723,  30687,  30651,  30615,  30578,  30541,  30503,
 30465,  30427,  30389,  30350,  30312,  30272,  30233,  30193,  30153,  30112,  30072,  30031,  29989,  29948,  29906,  29863,  29821,  29778,  29735,  29692,
 29648,  29604,  29560,  29515,  29470,  29425,  29380,  29334,  29288,  29242,  29195,  29148,  29101,  29054,  29006,  28958,  28910,  28861,  28812,  28763,
 28713,  28664,  28614,  28563,  28513,  28462,  28411,  28359,  28308,  28256,  28203,  28151,  28098,  28045,  27992,  27938,  27884,  27830,  27775,  27721,
 27666,  27610,  27555,  27499,  27443,  27386,  27330,  27273,  27216,  27158,  27100,  27042,  26984,  26926,  26867,  26808,  26748,  26689,  26629,  26569,
 26509,  26448,  26387,  26326,  26264,  26203,  26141,  26079,  26016,  25953,  25891,  25827,  25764,  25700,  25636,  25572,  25507,  25443,  25378,  25312,
 25247,  25181,  25115,  25049,  24982,  24916,  24849,  24782,  24714,  24646,  24578,  24510,  24442,  24373,  24304,  24235,  24166,  24096,  24026,  23956,
 23886,  23815,  23744,  23673,  23602,  23530,  23459,  23387,  23314,  23242,  23169,  23096,  23023,  22950,  22876,  22802,  22728,  22654,  22580,  22505,
 22430,  22355,  22280,  22204,  22128,  22052,  21976,  21899,  21823,  21746,  21669,  21591,  21514,  21436,  21358,  21280,  21202,  21123,  21044,  20965,
 20886,  20807,  20727,  20647,  20567,  20487,  20406,  20326,  20245,  20164,  20083,  20001,  19920,  19838,  19756,  19673,  19591,  19508,  19426,  19343,
 19259,  19176,  19093,  19009,  18925,  18841,  18756,  18672,  18587,  18502,  18417,  18332,  18247,  18161,  18075,  17989,  17903,  17817,  17730,  17644,
 17557,  17470,  17383,  17295,  17208,  17120,  17032,  16944,  16856,  16768,  16679,  16591,  16502,  16413,  16324,  16234,  16145,  16055,  15965,  15875,
 15785,  15695,  15604,  15514,  15423,  15332,  15241,  15150,  15059,  14967,  14875,  14784,  14692,  14600,  14507,  14415,  14322,  14230,  14137,  14044,
 13951,  13858,  13764,  13671,  13577,  13484,  13390,  13296,  13202,  13107,  13013,  12918,  12824,  12729,  12634,  12539,  12444,  12348,  12253,  12157,
 12062,  11966,  11870,  11774,  11678,  11582,  11485,  11389,  11292,  11196,  11099,  11002,  10905,  10808,  10711,  10613,  10516,  10418,  10321,  10223,
 10125,  10027,   9929,   9831,   9733,   9634,   9536,   9437,   9339,   9240,   9141,   9042,   8943,   8844,   8745,   8646,   8546,   8447,   8348,   8248,
  8148,   8049,   7949,   7849,   7749,   7649,   7549,   7448,   7348,   7248,   7147,   7047,   6946,   6846,   6745,   6644,   6543,   6442,   6342,   6241,
  6139,   6038,   5937,   5836,   5734,   5633,   5532,   5430,   5329,   5227,   5125,   5024,   4922,   4820,   4718,   4616,   4514,   4412,   4310,   4208,
  4106,   4004,   3902,   3800,   3697,   3595,   3493,   3390,   3288,   3186,   3083,   2981,   2878,   2776,   2673,   2570,   2468,   2365,   2262,   2160,
  2057,   1954,   1851,   1749,   1646,   1543,   1440,   1337,   1234,   1132,   1029,    926,    823,    720,    617,    514,    411,    308,    205,    102,
     0,   -102,   -205,   -308,   -411,   -514,   -617,   -720,   -823,   -926,  -1029,  -1132,  -1234,  -1337,  -1440,  -1543,  -1646,  -1749,  -1851,  -1954,
 -2057,  -2160,  -2262,  -2365,  -2468,  -2570,  -2673,  -2776,  -2878,  -2981,  -3083,  -3186,  -3288,  -3390,  -3493,  -3595,  -3697,  -3800,  -3902,  -4004,
 -4106,  -4208,  -4310,  -4412,  -4514,  -4616,  -4718,  -4820,  -4922,  -5024,  -5125,  -5227,  -5329,  -5430,  -5532,  -5633,  -5734,  -5836,  -5937,  -6038,
 -6139,  -6241,  -6342,  -6442,  -6543,  -6644,  -6745,  -6846,  -6946,  -7047,  -7147,  -7248,  -7348,  -7448,  -7549,  -7649,  -7749,  -7849,  -7949,  -8049,
 -8148,  -8248,  -8348,  -8447,  -8546,  -8646,  -8745,  -8844,  -8943,  -9042,  -9141,  -9240,  -9339,  -9437,  -9536,  -9634,  -9733,  -9831,  -9929, -10027,
-10125, -10223, -10321, -10418, -10516, -10613, -10711, -10808, -10905, -11002, -11099, -11196, -11292, -11389, -11485, -11582, -11678, -11774, -11870, -11966,
-12062, -12157, -12253, -12348, -12444, -12539, -12634, -12729, -12824, -12918, -13013, -13107, -13202, -13296, -13390, -13484, -13577, -13671, -13764, -13858,
-13951, -14044, -14137, -14230, -14322, -14415, -14507, -14600, -14692, -14784, -14875, -14967, -15059, -15150, -15241, -15332, -15423, -15514, -15604, -15695,
-15785, -15875, -15965, -16055, -16145, -16234, -16324, -16413, -16502, -16591, -16679, -16768, -16856, -16944, -17032, -17120, -17208, -17295, -17383, -17470,
-17557, -17644, -17730, -17817, -17903, -17989, -18075, -18161, -18247, -18332, -18417, -18502, -18587, -18672, -18756, -18841, -18925, -19009, -19093, -19176,
-19259, -19343, -19426, -19508, -19591, -19673, -19756, -19838, -19920, -20001, -20083, -20164, -20245, -20326, -20406, -20487, -20567, -20647, -20727, -20807,
-20886, -20965, -21044, -21123, -21202, -21280, -21358, -21436, -21514, -21591, -21669, -21746, -21823, -21899, -21976, -22052, -22128, -22204, -22280, -22355,
-22430, -22505, -22580, -22654, -22728, -22802, -22876, -22950, -23023, -23096, -23169, -23242, -23314, -23387, -23459, -23530, -23602, -23673, -23744, -23815,
-23886, -23956, -24026, -24096, -24166, -24235, -24304, -24373, -24442, -24510, -24578, -24646, -24714, -24782, -24849, -24916, -24982, -25049, -25115, -25181,
-25247, -25312, -25378, -25443, -25507, -25572, -25636, -25700, -25764, -25827, -25891, -25953, -26016, -26079, -26141, -26203, -26264, -26326, -26387, -26448,
-26509, -26569, -26629, -26689, -26748, -26808, -26867, -26926, -26984, -27042, -27100, -27158, -27216, -27273, -27330, -27386, -27443, -27499, -27555, -27610,
-27666, -27721, -27775, -27830, -27884, -27938, -27992, -28045, -28098, -28151, -28203, -28256, -28308, -28359, -28411, -28462, -28513, -28563, -28614, -28664,
-28713, -28763, -28812, -28861, -28910, -28958, -29006, -29054, -29101, -29148, -29195, -29242, -29288, -29334, -29380, -29425, -29470, -29515, -29560, -29604,
-29648, -29692, -29735, -29778, -29821, -29863, -29906, -29948, -29989, -30031, -30072, -30112, -30153, -30193, -30233, -30272, -30312, -30350, -30389, -30427,
-30465, -30503, -30541, -30578, -30615, -30651, -30687, -30723, -30759, -30794, -30829, -30864, -30898, -30933, -30966, -31000, -31033, -31066, -31099, -31131,
-31163, -31194, -31226, -31257, -31288, -31318, -31348, -31378, -31407, -31437, -31465, -31494, -31522, -31550, -31578, -31605, -31632, -31659, -31685, -31711,
-31737, -31763, -31788, -31812, -31837, -31861, -31885, -31909, -31932, -31955, -31977, -32000, -32022, -32043, -32065, -32086, -32106, -32127, -32147, -32167,
-32186, -32205, -32224, -32243, -32261, -32279, -32296, -32313, -32330, -32347, -32363, -32379, -32395, -32410, -32425, -32440, -32454, -32468, -32482, -32495,
-32508, -32521, -32533, -32545, -32557, -32569, -32580, -32591, -32601, -32611, -32621, -32631, -32640, -32649, -32657, -32665, -32673, -32681, -32688, -32695,
-32702, -32708, -32714, -32720, -32725, -32730, -32735, -32739, -32743, -32747, -32750, -32753, -32756, -32759, -32761, -32762, -32764, -32765, -32766, -32766,
-32767, -32766, -32766, -32765, -32764, -32762, -32761, -32759, -32756, -32753, -32750, -32747, -32743, -32739, -32735, -32730, -32725, -32720, -32714, -32708,
-32702, -32695, -32688, -32681, -32673, -32665, -32657, -32649, -32640, -32631, -32621, -32611, -32601, -32591, -32580, -32569, -32557, -32545, -32533, -32521,
-32508, -32495, -32482, -32468, -32454, -32440, -32425, -32410, -32395, -32379, -32363, -32347, -32330, -32313, -32296, -32279, -32261, -32243, -32224, -32205,
-32186, -32167, -32147, -32127, -32106, -32086, -32065, -32043, -32022, -32000, -31977, -31955, -31932, -31909, -31885, -31861, -31837, -31812, -31788, -31763,
-31737, -31711, -31685, -31659, -31632, -31605, -31578, -31550, -31522, -31494, -31465, -31437, -31407, -31378, -31348, -31318, -31288, -31257, -31226, -31194,
-31163, -31131, -31099, -31066, -31033, -31000, -30966, -30933, -30898, -30864, -30829, -30794, -30759, -30723, -30687, -30651, -30615, -30578, -30541, -30503,
-30465, -30427, -30389, -30350, -30312, -30272, -30233, -30193, -30153, -30112, -30072, -30031, -29989, -29948, -29906, -29863, -29821, -29778, -29735, -29692,
-29648, -29604, -29560, -29515, -29470, -29425, -29380, -29334, -29288, -29242, -29195, -29148, -29101, -29054, -29006, -28958, -28910, -28861, -28812, -28763,
-28713, -28664, -28614, -28563, -28513, -28462, -28411, -28359, -28308, -28256, -28203, -28151, -28098, -28045, -27992, -27938, -27884, -27830, -27775, -27721,
-27666, -27610, -27555, -27499, -27443, -27386, -27330, -27273, -27216, -27158, -27100, -27042, -26984, -26926, -26867, -26808, -26748, -26689, -26629, -26569,
-26509, -26448, -26387, -26326, -26264, -26203, -26141, -26079, -26016, -25953, -25891, -25827, -25764, -25700, -25636, -25572, -25507, -25443, -25378, -25312,
-25247, -25181, -25115, -25049, -24982, -24916, -24849, -24782, -24714, -24646, -24578, -24510, -24442, -24373, -24304, -24235, -24166, -24096, -24026, -23956,
-23886, -23815, -23744, -23673, -23602, -23530, -23459, -23387, -23314, -23242, -23169, -23096, -23023, -22950, -22876, -22802, -22728, -22654, -22580, -22505,
-22430, -22355, -22280, -22204, -22128, -22052, -21976, -21899, -21823, -21746, -21669, -21591, -21514, -21436, -21358, -21280, -21202, -21123, -21044, -20965,
-20886, -20807, -20727, -20647, -20567, -20487, -20406, -20326, -20245, -20164, -20083, -20001, -19920, -19838, -19756, -19673, -19591, -19508, -19426, -19343,
-19259, -19176, -19093, -19009, -18925, -18841, -18756, -18672, -18587, -18502, -18417, -18332, -18247, -18161, -18075, -17989, -17903, -17817, -17730, -17644,
-17557, -17470, -17383, -17295, -17208, -17120, -17032, -16944, -16856, -16768, -16679, -16591, -16502, -16413, -16324, -16234, -16145, -16055, -15965, -15875,
-15785, -15695, -15604, -15514, -15423, -15332, -15241, -15150, -15059, -14967, -14875, -14784, -14692, -14600, -14507, -14415, -14322, -14230, -14137, -14044,
-13951, -13858, -13764, -13671, -13577, -13484, -13390, -13296, -13202, -13107, -13013, -12918, -12824, -12729, -12634, -12539, -12444, -12348, -12253, -12157,
-12062, -11966, -11870, -11774, -11678, -11582, -11485, -11389, -11292, -11196, -11099, -11002, -10905, -10808, -10711, -10613, -10516, -10418, -10321, -10223,
-10125, -10027,  -9929,  -9831,  -9733,  -9634,  -9536,  -9437,  -9339,  -9240,  -9141,  -9042,  -8943,  -8844,  -8745,  -8646,  -8546,  -8447,  -8348,  -8248,
 -8148,  -8049,  -7949,  -7849,  -7749,  -7649,  -7549,  -7448,  -7348,  -7248,  -7147,  -7047,  -6946,  -6846,  -6745,  -6644,  -6543,  -6442,  -6342,  -6241,
 -6139,  -6038,  -5937,  -5836,  -5734,  -5633,  -5532,  -5430,  -5329,  -5227,  -5125,  -5024,  -4922,  -4820,  -4718,  -4616,  -4514,  -4412,  -4310,  -4208,
 -4106,  -4004,  -3902,  -3800,  -3697,  -3595,  -3493,  -3390,  -3288,  -3186,  -3083,  -2981,  -2878,  -2776,  -2673,  -2570,  -2468,  -2365,  -2262,  -2160,
 -2057,  -1954,  -1851,  -1749,  -1646,  -1543,  -1440,  -1337,  -1234,  -1132,  -1029,   -926,   -823,   -720,   -617,   -514,   -411,   -308,   -205,   -102,
};

volatile uint_fast32_t increment[VOICEM] = {0};    // 52.2 * freq
volatile uint_fast32_t counter[VOICEM] = {0};      // position in LUT
volatile int_fast8_t volume[VOICEM] = {0};         // 0 - voice_number

static int_fast32_t bobMax = LUTSIZE << 10;
static int_fast8_t voice_number = 255;      // 255 - 0 available voice slots
static int_fast8_t voice_counter = 0;       // 0 - VOICEM number of voices

uint32_t keys_freq[108 + 48] = {
    164,    173,    184,    194,    206,    218,    231,    245,    260,    275,    291,    309,
    327,    346,    367,    389,    412,    437,    462,    490,    519,    550,    583,    617,
    654,    693,    734,    778,    824,    873,    925,    980,    1038,   1100,   1165,   1235,
    1308,   1386,   1468,   1556,   1648,   1746,   1850,   1960,   2077,   2200,   2331,   2470,
    2616,   2772,   2937,   3111,   3296,   3492,   3670,   3920,   4153,   4400,   4662,   4939,
    5233,   5544,   5873,   6223,   6593,   6985,   7400,   7840,   8306,   8800,   9323,   9878,
    10465,  11087,  11747,  12445,  13185,  13969,  14800,  15680,  16612,  17600,  18647,  19755,
    20930,  22175,  23493,  24890,  26370,  27938,  29600,  31360,  33224,  35200,  37293,  39511,
    41860,  44349,  46986,  49780,  52740,  55877,  59109,  62719,  66449,  70400,  74586,  79021,
    BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,
    BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,
    BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,
    BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,BROKENF,
};
static uint8_t oct_trans = 2; // 2 * 12
static uint8_t note_trans = 0; // 2 * 12


// DDS control variables
/*
typedef enum _mod{
    none = 0,
    lfo1 = 1,
    lfo2 = 2,
    noiser = 3,
    note = 4,
    speed = 5,
    pitch_w = 6,
    mod_w = 7,
    slider1 = 8,
    slider2 = 9,
    slider3 = 10,
    slider4 = 11,
    slider5 = 12
} MODIFIER;
typedef enum _shape{
    sinusoid = 0,
    triangle = 1,
    square = 2,
    sawtooth = 3,
    inv_sawtooth = 4
} SHAPE;
typedef enum _oscm{
    frees = 0,
    retriggers = 1
} O_MODE;

typedef enum _state{
    off_t = 0,
    on_t = 1
} STATE;

static uint8_t main_volume = 50;  // 0 ... 99
static enum _stereo{
    l_r,
    l_only,
    r_only
} stereo = l_r;

static uint8_t osc_count_limit = 61;
static uint8_t max_osc_mode = frees;

// oct_trans - piano has 9 octaves, our synth has 5, it starts at the second already - 0 ... (4 * 12) = 48
static uint8_t mixer1 = 50; // mixer's first channel
static uint8_t mixer2 = 50; // mixer's second channel


static SHAPE osc1_shape = sinusoid;
static uint8_t osc1_osc_count = 0; // 0 ... 5(?)
//static SO_MODE osc1_osc_mode = harmonic;              all sub oscillators are harmonic
//static uint8_t osc1_osc_unison = 0; // 0 ... 100
static int8_t osc1_trans = 0;  // transpose -24 ... 24
static int8_t osc1_cent = 0;   // 0 ... 100
static MODIFIER osc1_trans_mod = none; // modifier for osc trans
static MODIFIER osc1_cent_mod = none;  // modifier for osc cent

static SHAPE osc2_shape = sinusoid;
static uint8_t osc2_osc_count = 0; // 0 ... 5(?)
//static SO_MODE osc2_osc_mode = harmonic;              all sub oscillators are harmonic
//static uint8_t osc2_osc_unison = 0; // 0 ... 100
static int8_t osc2_trans = 0;  // transpose -24 ... 24
static int8_t osc2_cent = 0;   // 0 ... 100
static MODIFIER osc2_trans_mod = none; // modifier for osc trans
static MODIFIER osc2_cent_mod = none;  // modifier for osc cent

static uint16_t adsr_a = 0;    // 0 ... 10000 ms
static uint16_t adsr_d = 0;    // 0 ... 10000 ms
static uint16_t adsr_s = 0;    // 0 ... 10000 ms
static uint16_t adsr_sl = 0;   // 0 ... 100%
static uint16_t adsr_r = 1;    // 1 ... 10000 ms
static MODIFIER adsr_a_mod = none;    // modifier for adsr A parameter
static MODIFIER adsr_d_mod = none;    // modifier for adsr D parameter
static MODIFIER adsr_s_mod = none;    // modifier for adsr S parameter
static MODIFIER adsr_sl_mod = none;   // modifier for adsr SL parameter
static MODIFIER adsr_r_mod = none;    // modifier for adsr R parameter

static uint8_t amp_pw = 0;  // 0 ... 99
static uint8_t amp_mw = 0;  // 0 ... 99
static uint8_t amp_kn = 0;  // 0 ... 99
static uint8_t amp_ks = 0;  // 0 ... 99
static uint8_t amp_s1 = 0;  // 0 ... 99
static uint8_t amp_s2 = 0;  // 0 ... 99
static uint8_t amp_s3 = 0;  // 0 ... 99
static uint8_t amp_s4 = 0;  // 0 ... 99
static uint8_t amp_s5 = 0;  // 0 ... 99

static STATE lfo1_state = off_t; // 0 - off, 1 - on
static O_MODE lfo1_mode = frees;
static SHAPE lfo1_shape = sinusoid;
static uint8_t lfo1_amp = 0;   // 0 ... 100
static uint8_t lfo1_freq = 0;  // 0 ... 250
static MODIFIER lfo1_amp_mod = none;  // modifier for lfo1 amplitude
static MODIFIER lfo1_freq_mod = none; // modifier for lfo1 frequency

static STATE lfo2_state = off_t; // 0 - off, 1 - on
static O_MODE lfo2_mode = frees;
static SHAPE lfo2_shape = sinusoid;
static uint8_t lfo2_amp = 0;   // 0 ... 100
static uint8_t lfo2_freq = 0;  // 0 ... 250
static MODIFIER lfo2_amp_mod = none;  // modifier for lfo2 amplitude
static MODIFIER lfo2_freq_mod = none; // modifier for lfo2 frequency

// MOD ENV variables
static STATE me_state = off_t;      // 0 - off, 1 - on
static uint16_t me_a = 0;       // 0 ... 10000 ms
static uint16_t me_d = 0;       // 0 ... 10000 ms
static uint16_t me_s = 0;       // 0 ... 10000 ms
static uint16_t me_sl = 0;      // 0 ... 100%
static uint16_t me_r = 1;       // 1 ... 10000 ms
static MODIFIER me_a_mod = none;    // modifier for MOD ENV A parameter
static MODIFIER me_d_mod = none;    // modifier for MOD ENV D parameter
static MODIFIER me_s_mod = none;    // modifier for MOD ENV S parameter
static MODIFIER me_sl_mod = none;   // modifier for MOD ENV SL parameter
static MODIFIER me_r_mod = none;    // modifier for MOD ENV R parameter
*/

// ============================================================ TASK 0 FUNCTIONS

void add_voice(uint32_t frequency, uint16_t vol, uint16_t number){
    if((voice_number > 0) && (voice_counter < VOICEM)){
        volume[number] = vol;
        voice_number -= vol;
        //voices[number].counter = 0;
        increment[number] = 256 * frequency / 50;
        voice_counter++;
    }
}

void remove_voice(uint16_t number){
    if(voice_counter > 0){
        voice_number += volume[number];
        volume[number] = 0;
        increment[number] = 0;
        counter[number] =0;
        voice_counter--;
    }
}

// ============================================================ TASK 1 FUNCTIONS

void serial_command(uint8_t uart_code, uint8_t uart_message){
    switch(uart_code){
    case 110:
        break;
    default:
        break;
    }
}

void serial_ops(void){
    uint8_t uart_code = 0;
    uint8_t uart_message = 0;
    uint8_t uart_count = 0;

    uart_count += serial1_read(&uart_code, 1);
    uart_count += serial1_read(&uart_message, 1);

    if(uart_count == 2){
        if((uart_code >= 1) && (uart_code <= 108)){
            if(uart_message == 0)
                remove_voice(0);
            else
                add_voice(keys_freq[(12 * oct_trans) + note_trans + uart_code], 250, 0);
        }
        else
            serial_command(uart_code, uart_message);
    }
}

// ============================================================ MAIN FUNCTIONS

void task0(void){ // can't use float in ISR
    int_fast16_t out_r = 0, out_l = 0;
    uint_fast8_t aux = 0;
    uint_fast32_t localCounter = 0;



    for(aux = 0; aux < VOICEM; aux++){
        localCounter = counter[aux];
        localCounter += increment[aux];
        if(localCounter >= bobMax)
            localCounter -= bobMax;
        out_r += lut_r[localCounter >> 10] * volume[aux];
        out_l += lut_l[localCounter >> 10] * volume[aux];
        counter[aux] = localCounter;
    }

    i2s_output(out_r, out_l);  // R - L
}

void task1(void){
    //volatile static uint_fast8_t led = 0;

    while((serial1_check() / 2) > 0){
        serial_ops();
    }

    // ADSR
    // LFO1
    // LFO2
    // MOD_ENV
}

/* all core 1 operations will be executed in task1()
void core1_loop(void){
    vTaskDelay(1);
}
*/

void task_init(void){
    // empty for now
}
